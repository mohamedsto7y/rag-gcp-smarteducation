{
  "id": "doc_047",
  "title": "Dilution (neural networks)",
  "url": "https://en.wikipedia.org/wiki/Dilution_(neural_networks)",
  "topic": "Dropout (neural networks)",
  "content": "Dropout and dilution (also called DropConnect) are regularization techniques for reducing overfitting in artificial neural networks by preventing complex co-adaptations on training data. They are an efficient way of performing model averaging with neural networks. Dilution refers to randomly decreasing weights towards zero, while dropout refers to randomly setting the outputs of hidden neurons to zero. Both are usually performed during the training process of a neural network, not during inference.\n\n\n== Types and uses ==\nDilution is usually split in weak dilution and strong dilution. Weak dilution describes the process in which the finite fraction of removed connections is small, and strong dilution refers to when this fraction is large. There is no clear distinction on where the limit between strong and weak dilution is, and often the distinction is dependent on the precedent of a specific use-case and has implications for how to solve for exact solutions.\nSometimes dilution is used for adding damping noise to the inputs. In that case, weak dilution refers to adding a small amount of damping noise, while strong dilution refers to adding a greater amount of damping noise. Both can be rewritten as variants of weight dilution.\nThese techniques are also sometimes referred to as random pruning of weights, but this is usually a non-recurring one-way operation. The network is pruned, and then kept if it is an improvement over the previous model. Dilution and dropout both refer to an iterative process. The pruning of weights typically does not imply that the network continues learning, while in dilution/dropout, the network continues to learn after the technique is applied.\n\n\n== Generalized linear network ==\nOutput from a layer of linear nodes, in an artificial neural net can be described as\n\n  \n    \n      \n        \n          y\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle y_{i}}\n  \n – output from node \n  \n    \n      \n        i\n      \n    \n    {\\displaystyle i}\n  \n\n  \n    \n      \n        \n          w\n          \n            i\n            j\n          \n        \n      \n    \n    {\\displaystyle w_{ij}}\n  \n – real weight before dilution, also called the Hebb connection strength\n\n  \n    \n      \n        \n          x\n          \n            j\n          \n        \n      \n    \n    {\\displaystyle x_{j}}\n  \n – input from node \n  \n    \n      \n        j\n      \n    \n    {\\displaystyle j}\n  \n\nThis can be written in vector notation as\n\n  \n    \n      \n        \n          y\n        \n      \n    \n    {\\displaystyle \\mathbf {y} }\n  \n – output vector\n\n  \n    \n      \n        \n          W\n        \n      \n    \n    {\\displaystyle \\mathbf {W} }\n  \n – weight matrix\n\n  \n    \n      \n        \n          x\n        \n      \n    \n    {\\displaystyle \\mathbf {x} }\n  \n – input vector\nEquations (1) and (2) are used in the subsequent sections.\n\n\n== Weak dilution ==\nDuring weak dilution, the finite fraction of removed connections (the weights) is small, giving rise to a tiny uncertainty. This edge-case can be solved exactly with mean field theory. In weak dilution the impact on the weights can be described as\n\n  \n    \n      \n        \n          \n            \n              \n                w\n                ^\n              \n            \n          \n          \n            i\n            j\n          \n        \n      \n    \n    {\\displaystyle {\\hat {w}}_{ij}}\n  \n – diluted weight\n\n  \n    \n      \n        \n          w\n          \n            i\n            j\n          \n        \n      \n    \n    {\\displaystyle w_{ij}}\n  \n – real weight before dilution\n\n  \n    \n      \n        P\n        (\n        c\n        )\n      \n    \n    {\\displaystyle P(c)}\n  \n – the probability of \n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n  \n, the probability of keeping a weight\nThe interpretation of probability \n  \n    \n      \n        P\n        (\n        c\n        )\n      \n    \n    {\\displaystyle P(c)}\n  \n can also be changed from keeping a weight into pruning a weight.\nIn vector notation this can be written as\n\nwhere the function \n  \n    \n      \n        g\n        ⁡\n        (\n        ⋅\n        )\n      \n    \n    {\\displaystyle \\operatorname {g} (\\cdot )}\n  \n imposes the previous dilution.\nIn weak dilution only a small and fixed fraction of the weights are diluted. When the number of terms in the sum goes to infinite (the weights for each node) it is still infinite (the fraction is fixed), thus mean field theory can be applied. In the notation from Hertz et al. this would be written as\n\n  \n    \n      \n        \n          ⟨\n          \n            h\n            \n              i\n            \n          \n          ⟩\n        \n      \n    \n    {\\displaystyle \\left\\langle h_{i}\\right\\rangle }\n  \n the mean field temperature\n\n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n  \n – a scaling factor for the temperature from the probability of keeping the weight\n\n  \n    \n      \n        \n          w\n          \n            i\n            j\n          \n        \n      \n    \n    {\\displaystyle w_{ij}}\n  \n – real weight before dilution, also called the Hebb connection strength\n\n  \n    \n      \n        \n          ⟨\n          \n            S\n            \n              j\n            \n          \n          ⟩\n        \n      \n    \n    {\\displaystyle \\left\\langle S_{j}\\right\\rangle }\n  \n – the mean stable equilibrium states\nThere are some assumptions for this to hold, which are not listed here.\n\n\n== Strong dilution ==\nWhen the dilution is strong, the finite fraction of removed connections (the weights) is large, giving rise to a huge uncertainty.\n\n\n== Dropout ==\nDropout is a special case of the previous weight equation (3), where the aforementioned equation is adjusted to remove a whole row in the vector matrix, and not only random weights\n\n  \n    \n      \n        P\n        (\n        c\n        )\n      \n    \n    {\\displaystyle P(c)}\n  \n – the probability \n  \n    \n      \n        c\n      \n    \n    {\\displaystyle c}\n  \n to keep a row in the weight matrix\n\n  \n    \n      \n        \n          \n            w\n          \n          \n            j\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {w} _{j}}\n  \n – real row in the weight matrix before dropout\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  w\n                \n                ^\n              \n            \n          \n          \n            j\n          \n        \n      \n    \n    {\\displaystyle {\\hat {\\mathbf {w} }}_{j}}\n  \n – diluted row in the weight matrix\nBecause dropout removes a whole row from the vector matrix, the previous (unlisted) assumptions for weak dilution and the use of mean field theory are not applicable.\nThe process by which the node is driven to zero, whether by setting the weights to zero, by “removing the node”, or by some other means, does not impact the end result and does not create a new and unique case. If the neural net is processed by a high-performance digital array-multiplicator, then it is likely more effective to drive the value to zero late in the process graph. If the net is processed by a constrained processor, perhaps even an analog neuromorphic processor, then it is likely a more power-efficient solution is to drive the value to zero early in the process graph.\n\n\n== Google's patent ==\nAlthough there have been examples of randomly removing connections between neurons in a neural network to improve models, this technique was first introduced with the name dropout by Geoffrey Hinton, et al. in 2012. Google currently holds the patent for the dropout technique.\n\n\n== See also ==\nAlexNet\nConvolutional neural network § Dropout\n\n\n== Notes ==\n\n\n== References =="
}