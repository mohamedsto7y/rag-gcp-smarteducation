{
  "id": "doc_017",
  "title": "Logistic regression",
  "url": "https://en.wikipedia.org/wiki/Logistic_regression",
  "topic": "Logistic regression",
  "content": "In statistics, a logistic model (or logit model) is a statistical model that models the log-odds of an event as a linear combination of one or more independent variables. In regression analysis, logistic regression (or logit regression) estimates the parameters of a logistic model (the coefficients in the linear or non linear combinations). In binary logistic regression there is a single binary dependent variable, coded by an indicator variable, where the two values are labeled \"0\" and \"1\", while the independent variables can each be a binary variable (two classes, coded by an indicator variable) or a continuous variable (any real value). The corresponding probability of the value labeled \"1\" can vary between 0 (certainly the value \"0\") and 1 (certainly the value \"1\"), hence the labeling; the function that converts log-odds to probability is the logistic function, hence the name. The unit of measurement for the log-odds scale is called a logit, from logistic unit, hence the alternative names. See § Background and § Definition for formal mathematics, and § Example for a worked example.\nBinary variables are widely used in statistics to model the probability of a certain class or event taking place, such as the probability of a team winning, of a patient being healthy, etc. (see § Applications), and the logistic model has been the most commonly used model for binary regression since about 1970. Binary variables can be generalized to categorical variables when there are more than two possible values (e.g. whether an image is of a cat, dog, lion, etc.), and the binary logistic regression generalized to multinomial logistic regression. If the multiple categories are ordered, one can use the ordinal logistic regression (for example the proportional odds ordinal logistic model). See § Extensions for further extensions. The logistic regression model itself simply models probability of output in terms of input and does not perform statistical classification (it is not a classifier), though it can be used to make a classifier, for instance by choosing a cutoff value and classifying inputs with probability greater than the cutoff as one class, below the cutoff as the other; this is a common way to make a binary classifier.\nAnalogous linear models for binary variables with a different sigmoid function instead of the logistic function (to convert the linear combination to a probability) can also be used, most notably the probit model; see § Alternatives. The defining characteristic of the logistic model is that increasing one of the independent variables multiplicatively scales the odds of the given outcome at a constant rate, with each independent variable having its own parameter; for a binary dependent variable this generalizes the odds ratio. More abstractly, the logistic function is the natural parameter for the Bernoulli distribution, and in this sense is the \"simplest\" way to convert a real number to a probability.\nThe parameters of a logistic regression are most commonly estimated by maximum-likelihood estimation (MLE). This does not have a closed-form expression, unlike linear least squares; see § Model fitting. Logistic regression by MLE plays a similarly basic role for binary or categorical responses as linear regression by ordinary least squares (OLS) plays for scalar responses: it is a simple, well-analyzed baseline model; see § Comparison with linear regression for discussion. The logistic regression as a general statistical model was originally developed and popularized primarily by Joseph Berkson, beginning in Berkson (1944), where he coined \"logit\"; see § History.\n\n\n== Applications ==\n\n\n=== General ===\nLogistic regression is used in various fields, including machine learning, most medical fields, and social sciences. For example, the Trauma and Injury Severity Score (TRISS), which is widely used to predict mortality in injured patients, was originally developed by Boyd et al. using logistic regression.  Many other medical scales used to assess severity of a patient have been developed using logistic regression. Logistic regression may be used to predict the risk of developing a given disease (e.g. diabetes; coronary heart disease), based on observed characteristics of the patient (age, sex, body mass index, results of various blood tests, etc.).  Another example might be to predict whether a Nepalese voter will vote Nepali Congress or Communist Party of Nepal or for any other party, based on age, income, sex, race, state of residence, votes in previous elections, etc. The technique can also be used in engineering, especially for predicting the probability of failure of a given process, system or product. It is also used in marketing applications such as prediction of a customer's propensity to purchase a product or halt a subscription, etc. In economics, it can be used to predict the likelihood of a person ending up in the labor force, and a business application would be to predict the likelihood of a homeowner defaulting on a mortgage. Conditional random fields, an extension of logistic regression to sequential data, are used in natural language processing. Disaster planners and engineers  rely on these models to predict decisions taken by householders or building occupants in small-scale and large-scales evacuations, such as building fires, wildfires, hurricanes among others. These models help in the development of reliable disaster managing plans and safer design for the built environment.\n\n\n=== Supervised machine learning ===\nLogistic regression is a supervised machine learning algorithm widely used for binary classification tasks, such as identifying whether an email is spam or not and diagnosing diseases by assessing the presence or absence of specific conditions based on patient test results. This approach utilizes the logistic (or sigmoid) function to transform a linear combination of input features into a probability value ranging between 0 and 1. This probability indicates the likelihood that a given input corresponds to one of two predefined categories. The essential mechanism of logistic regression is grounded in the logistic function's ability to model the probability of binary outcomes accurately. With its distinctive S-shaped curve, the logistic function effectively maps any real-valued number to a value within the 0 to 1 interval. This feature renders it particularly suitable for binary classification tasks, such as sorting emails into \"spam\" or \"not spam\". By calculating the probability that the dependent variable will be categorized into a specific group, logistic regression provides a probabilistic framework that supports informed decision-making.\n\n\n== Example ==\n\n\n=== Problem ===\nAs a simple example, we can use a logistic regression with one explanatory variable and two categories to answer the following question:\n\nA group of 20 students spends between 0 and 6 hours studying for an exam. How does the number of hours spent studying affect the probability of the student passing the exam?\n\nThe reason for using logistic regression for this problem is that the values of the dependent variable, pass and fail, while represented by \"1\" and \"0\", are not cardinal numbers. If the problem was changed so that pass/fail was replaced with the grade 0–100 (cardinal numbers), then simple regression analysis could be used.\nThe table shows the number of hours each student spent studying, and whether they passed (1) or failed (0).\n\nWe wish to fit a logistic function to the data consisting of the hours studied (xk) and the outcome of the test (yk =1 for pass, 0 for fail). The data points are indexed by the subscript k which runs from \n  \n    \n      \n        k\n        =\n        1\n      \n    \n    {\\displaystyle k=1}\n  \n to \n  \n    \n      \n        k\n        =\n        K\n        =\n        20\n      \n    \n    {\\displaystyle k=K=20}\n  \n. The x variable is called the \"explanatory variable\", and the y variable is called the \"categorical variable\" consisting of two categories: \"pass\" or \"fail\" corresponding to the categorical values 1 and 0 respectively.\n\n\n=== Model ===\n\nThe logistic function is of the form:\n\n  \n    \n      \n        p\n        (\n        x\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  (\n                  x\n                  −\n                  μ\n                  )\n                  \n                    /\n                  \n                  s\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p(x)={\\frac {1}{1+e^{-(x-\\mu )/s}}}}\n  \n\nwhere μ is a location parameter (the midpoint of the curve, where \n  \n    \n      \n        p\n        (\n        μ\n        )\n        =\n        1\n        \n          /\n        \n        2\n      \n    \n    {\\displaystyle p(\\mu )=1/2}\n  \n) and s is a scale parameter. This expression may be rewritten as:\n\n  \n    \n      \n        p\n        (\n        x\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  (\n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  x\n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p(x)={\\frac {1}{1+e^{-(\\beta _{0}+\\beta _{1}x)}}}}\n  \n\nwhere \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        =\n        −\n        μ\n        \n          /\n        \n        s\n      \n    \n    {\\displaystyle \\beta _{0}=-\\mu /s}\n  \n and is known as the intercept (it is the vertical intercept or y-intercept of the line \n  \n    \n      \n        y\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle y=\\beta _{0}+\\beta _{1}x}\n  \n), and \n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n        =\n        1\n        \n          /\n        \n        s\n      \n    \n    {\\displaystyle \\beta _{1}=1/s}\n  \n (inverse scale parameter or rate parameter): these are the y-intercept and slope of the log-odds as a function of x. Conversely, \n  \n    \n      \n        μ\n        =\n        −\n        \n          β\n          \n            0\n          \n        \n        \n          /\n        \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\mu =-\\beta _{0}/\\beta _{1}}\n  \n and \n  \n    \n      \n        s\n        =\n        1\n        \n          /\n        \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle s=1/\\beta _{1}}\n  \n.\nNote that this model is actually an oversimplification, as it implies that every student will pass if they study indefinitely (limit = 1).\n\n\n=== Fit ===\nThe usual measure of goodness of fit for a logistic regression uses logistic loss (or log loss), the negative log-likelihood. For a given xk and yk, write \n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        =\n        p\n        (\n        \n          x\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle p_{k}=p(x_{k})}\n  \n. The ⁠\n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle p_{k}}\n  \n⁠ are the probabilities that the corresponding ⁠\n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle y_{k}}\n  \n⁠ will equal one, and ⁠\n  \n    \n      \n        1\n        −\n        \n          p\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle 1-p_{k}}\n  \n⁠ are the probabilities that they will be zero (see Bernoulli distribution). We wish to find the values of ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠ which give the \"best fit\" to the data. In the case of linear regression, the sum of the squared deviations of the fit from the data points (yk), the squared error loss, is taken as a measure of the goodness of fit, and the best fit is obtained when that function is minimized.\nThe log loss for the k-th point ⁠\n  \n    \n      \n        \n          ℓ\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle \\ell _{k}}\n  \n⁠ is:\n\n  \n    \n      \n        \n          ℓ\n          \n            k\n          \n        \n        =\n        \n          \n            {\n            \n              \n                \n                  −\n                  ln\n                  ⁡\n                  \n                    p\n                    \n                      k\n                    \n                  \n                \n                \n                  \n                     if \n                  \n                  \n                    y\n                    \n                      k\n                    \n                  \n                  =\n                  1\n                  ,\n                \n              \n              \n                \n                  −\n                  ln\n                  ⁡\n                  (\n                  1\n                  −\n                  \n                    p\n                    \n                      k\n                    \n                  \n                  )\n                \n                \n                  \n                     if \n                  \n                  \n                    y\n                    \n                      k\n                    \n                  \n                  =\n                  0.\n                \n              \n            \n            \n          \n        \n      \n    \n    {\\displaystyle \\ell _{k}={\\begin{cases}-\\ln p_{k}&{\\text{ if }}y_{k}=1,\\\\-\\ln(1-p_{k})&{\\text{ if }}y_{k}=0.\\end{cases}}}\n  \n\nThe log loss can be interpreted as the \"surprisal\" of the actual outcome ⁠\n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle y_{k}}\n  \n⁠ relative to the prediction ⁠\n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle p_{k}}\n  \n⁠, and is a measure of information content. Log loss is always greater than or equal to 0, equals 0 only in case of a perfect prediction (i.e., when \n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle p_{k}=1}\n  \n and \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle y_{k}=1}\n  \n, or \n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle p_{k}=0}\n  \n and \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle y_{k}=0}\n  \n), and approaches infinity as the prediction gets worse (i.e., when \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle y_{k}=1}\n  \n and \n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        →\n        0\n      \n    \n    {\\displaystyle p_{k}\\to 0}\n  \n or \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle y_{k}=0}\n  \n and \n  \n    \n      \n        \n          p\n          \n            k\n          \n        \n        →\n        1\n      \n    \n    {\\displaystyle p_{k}\\to 1}\n  \n), meaning the actual outcome is \"more surprising\". Since the value of the logistic function is always strictly between zero and one, the log loss is always greater than zero and less than infinity. Unlike in a linear regression, where the model can have zero loss at a point by passing through a data point (and zero loss overall if all points are on a line), in a logistic regression it is not possible to have zero loss at any points, since ⁠\n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle y_{k}}\n  \n⁠ is either 0 or 1, but ⁠\n  \n    \n      \n        0\n        <\n        \n          p\n          \n            k\n          \n        \n        <\n        1\n      \n    \n    {\\displaystyle 0<p_{k}<1}\n  \n⁠.\nThese can be combined into a single expression:\n\n  \n    \n      \n        \n          ℓ\n          \n            k\n          \n        \n        =\n        −\n        \n          y\n          \n            k\n          \n        \n        ln\n        ⁡\n        \n          p\n          \n            k\n          \n        \n        −\n        (\n        1\n        −\n        \n          y\n          \n            k\n          \n        \n        )\n        ln\n        ⁡\n        (\n        1\n        −\n        \n          p\n          \n            k\n          \n        \n        )\n        .\n      \n    \n    {\\displaystyle \\ell _{k}=-y_{k}\\ln p_{k}-(1-y_{k})\\ln(1-p_{k}).}\n  \n\nThis expression is more formally known as the cross-entropy of the predicted distribution \n  \n    \n      \n        \n          \n            (\n          \n        \n        \n          p\n          \n            k\n          \n        \n        ,\n        (\n        1\n        −\n        \n          p\n          \n            k\n          \n        \n        )\n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle {\\big (}p_{k},(1-p_{k}){\\big )}}\n  \n from the actual distribution \n  \n    \n      \n        \n          \n            (\n          \n        \n        \n          y\n          \n            k\n          \n        \n        ,\n        (\n        1\n        −\n        \n          y\n          \n            k\n          \n        \n        )\n        \n          \n            )\n          \n        \n      \n    \n    {\\displaystyle {\\big (}y_{k},(1-y_{k}){\\big )}}\n  \n, as probability distributions on the two-element space of (pass, fail).\nThe sum of these, the total loss, is the overall negative log-likelihood ⁠\n  \n    \n      \n        −\n        ℓ\n      \n    \n    {\\displaystyle -\\ell }\n  \n⁠, and the best fit is obtained for those choices of ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠ for which ⁠\n  \n    \n      \n        −\n        ℓ\n      \n    \n    {\\displaystyle -\\ell }\n  \n⁠ is minimized.\nAlternatively, instead of minimizing the loss, one can maximize its inverse, the (positive) log-likelihood:\n\n  \n    \n      \n        ℓ\n        =\n        \n          ∑\n          \n            k\n            :\n            \n              y\n              \n                k\n              \n            \n            =\n            1\n          \n        \n        ln\n        ⁡\n        (\n        \n          p\n          \n            k\n          \n        \n        )\n        +\n        \n          ∑\n          \n            k\n            :\n            \n              y\n              \n                k\n              \n            \n            =\n            0\n          \n        \n        ln\n        ⁡\n        (\n        1\n        −\n        \n          p\n          \n            k\n          \n        \n        )\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          (\n          \n            \n            \n              y\n              \n                k\n              \n            \n            ln\n            ⁡\n            (\n            \n              p\n              \n                k\n              \n            \n            )\n            +\n            (\n            1\n            −\n            \n              y\n              \n                k\n              \n            \n            )\n            ln\n            ⁡\n            (\n            1\n            −\n            \n              p\n              \n                k\n              \n            \n            )\n          \n          )\n        \n      \n    \n    {\\displaystyle \\ell =\\sum _{k:y_{k}=1}\\ln(p_{k})+\\sum _{k:y_{k}=0}\\ln(1-p_{k})=\\sum _{k=1}^{K}\\left(\\,y_{k}\\ln(p_{k})+(1-y_{k})\\ln(1-p_{k})\\right)}\n  \n\nor equivalently maximize the likelihood function itself, which is the probability that the given data set is produced by a particular logistic function:\n\n  \n    \n      \n        L\n        =\n        \n          ∏\n          \n            k\n            :\n            \n              y\n              \n                k\n              \n            \n            =\n            1\n          \n        \n        \n          p\n          \n            k\n          \n        \n        \n        \n          ∏\n          \n            k\n            :\n            \n              y\n              \n                k\n              \n            \n            =\n            0\n          \n        \n        (\n        1\n        −\n        \n          p\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle L=\\prod _{k:y_{k}=1}p_{k}\\,\\prod _{k:y_{k}=0}(1-p_{k})}\n  \n\nThis method is known as maximum likelihood estimation.\n\n\n=== Parameter estimation ===\nSince ℓ is nonlinear in ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠, determining their optimum values will require numerical methods. One method of maximizing  ℓ is to require the derivatives of ℓ with respect to ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠ to be zero:\n\n  \n    \n      \n        0\n        =\n        \n          \n            \n              ∂\n              ℓ\n            \n            \n              ∂\n              \n                β\n                \n                  0\n                \n              \n            \n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        \n          y\n          \n            k\n          \n        \n        −\n        \n          p\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle 0={\\frac {\\partial \\ell }{\\partial \\beta _{0}}}=\\sum _{k=1}^{K}(y_{k}-p_{k})}\n  \n\n  \n    \n      \n        0\n        =\n        \n          \n            \n              ∂\n              ℓ\n            \n            \n              ∂\n              \n                β\n                \n                  1\n                \n              \n            \n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        \n          y\n          \n            k\n          \n        \n        −\n        \n          p\n          \n            k\n          \n        \n        )\n        \n          x\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle 0={\\frac {\\partial \\ell }{\\partial \\beta _{1}}}=\\sum _{k=1}^{K}(y_{k}-p_{k})x_{k}}\n  \n\nand the maximization procedure can be accomplished by solving the above two equations for ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠, which, again, will generally require the use of numerical methods.\nThe values of ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠ which maximize ℓ and L using the above data are found to be:\n\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        ≈\n        −\n        4.1\n      \n    \n    {\\displaystyle \\beta _{0}\\approx -4.1}\n  \n\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n        ≈\n        1.5\n      \n    \n    {\\displaystyle \\beta _{1}\\approx 1.5}\n  \n\nwhich yields a value for μ and s of:\n\n  \n    \n      \n        μ\n        =\n        −\n        \n          β\n          \n            0\n          \n        \n        \n          /\n        \n        \n          β\n          \n            1\n          \n        \n        ≈\n        2.7\n      \n    \n    {\\displaystyle \\mu =-\\beta _{0}/\\beta _{1}\\approx 2.7}\n  \n\n  \n    \n      \n        s\n        =\n        1\n        \n          /\n        \n        \n          β\n          \n            1\n          \n        \n        ≈\n        0.67\n      \n    \n    {\\displaystyle s=1/\\beta _{1}\\approx 0.67}\n  \n\n\n=== Predictions ===\nThe ⁠\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n⁠ and ⁠\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n⁠ coefficients may be entered into the logistic regression equation to estimate the probability of passing the exam.\nFor example, for a student who studies 2 hours, entering the value \n  \n    \n      \n        x\n        =\n        2\n      \n    \n    {\\displaystyle x=2}\n  \n into the equation gives the estimated probability of passing the exam of 0.25:\n\n  \n    \n      \n        t\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        2\n        \n          β\n          \n            1\n          \n        \n        ≈\n        −\n        4.1\n        +\n        2\n        ⋅\n        1.5\n        =\n        −\n        1.1\n      \n    \n    {\\displaystyle t=\\beta _{0}+2\\beta _{1}\\approx -4.1+2\\cdot 1.5=-1.1}\n  \n\n  \n    \n      \n        p\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  t\n                \n              \n            \n          \n        \n        ≈\n        0.25\n        =\n        \n          Probability of passing exam\n        \n      \n    \n    {\\displaystyle p={\\frac {1}{1+e^{-t}}}\\approx 0.25={\\text{Probability of passing exam}}}\n  \n\nSimilarly, for a student who studies 4 hours, the estimated probability of passing the exam is 0.87:\n\n  \n    \n      \n        t\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        4\n        \n          β\n          \n            1\n          \n        \n        ≈\n        −\n        4.1\n        +\n        4\n        ⋅\n        1.5\n        =\n        1.9\n      \n    \n    {\\displaystyle t=\\beta _{0}+4\\beta _{1}\\approx -4.1+4\\cdot 1.5=1.9}\n  \n\n  \n    \n      \n        p\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  t\n                \n              \n            \n          \n        \n        ≈\n        0.87\n        =\n        \n          Probability of passing exam\n        \n      \n    \n    {\\displaystyle p={\\frac {1}{1+e^{-t}}}\\approx 0.87={\\text{Probability of passing exam}}}\n  \n\nThis table shows the estimated probability of passing the exam for several values of hours studying.\n\n\n=== Model evaluation ===\nThe logistic regression analysis gives the following output.\n\nBy the Wald test, the output indicates that hours studying is significantly associated with the probability of passing the exam (\n  \n    \n      \n        p\n        =\n        0.017\n      \n    \n    {\\displaystyle p=0.017}\n  \n). Rather than the Wald method, the recommended method to calculate the p-value for logistic regression is the likelihood-ratio test (LRT), which for these data give \n  \n    \n      \n        p\n        ≈\n        0.00064\n      \n    \n    {\\displaystyle p\\approx 0.00064}\n  \n (see § Deviance and likelihood ratio tests below).\n\n\n=== Generalizations ===\nThis simple model is an example of binary logistic regression, and has one explanatory variable and a binary categorical variable which can assume one of two categorical values. Multinomial logistic regression is the generalization of binary logistic regression to include any number of explanatory variables and any number of categories.\n\n\n== Background ==\n\n\n=== Definition of the logistic function ===\nAn explanation of logistic regression can begin with an explanation of the standard logistic function. The logistic function is a sigmoid function, which takes any real input \n  \n    \n      \n        t\n      \n    \n    {\\displaystyle t}\n  \n, and outputs a value between zero and one. For the logit, this is interpreted as taking input log-odds and having output probability. The standard logistic function \n  \n    \n      \n        σ\n        :\n        \n          R\n        \n        →\n        (\n        0\n        ,\n        1\n        )\n      \n    \n    {\\displaystyle \\sigma :\\mathbb {R} \\rightarrow (0,1)}\n  \n is defined as follows:\n\n  \n    \n      \n        σ\n        (\n        t\n        )\n        =\n        \n          \n            \n              e\n              \n                t\n              \n            \n            \n              \n                e\n                \n                  t\n                \n              \n              +\n              1\n            \n          \n        \n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  t\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\sigma (t)={\\frac {e^{t}}{e^{t}+1}}={\\frac {1}{1+e^{-t}}}}\n  \n\nA graph of the logistic function on the t-interval (−6,6) is shown in Figure 1.\nLet us assume that \n  \n    \n      \n        t\n      \n    \n    {\\displaystyle t}\n  \n is a linear function of a single explanatory variable \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n (the case where \n  \n    \n      \n        t\n      \n    \n    {\\displaystyle t}\n  \n is a linear combination of multiple explanatory variables is treated similarly). We can then express \n  \n    \n      \n        t\n      \n    \n    {\\displaystyle t}\n  \n as follows:\n\n  \n    \n      \n        t\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle t=\\beta _{0}+\\beta _{1}x}\n  \n\nAnd the general logistic function \n  \n    \n      \n        p\n        :\n        \n          R\n        \n        →\n        (\n        0\n        ,\n        1\n        )\n      \n    \n    {\\displaystyle p:\\mathbb {R} \\rightarrow (0,1)}\n  \n can now be written as:\n\n  \n    \n      \n        p\n        (\n        x\n        )\n        =\n        σ\n        (\n        t\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  (\n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  x\n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p(x)=\\sigma (t)={\\frac {1}{1+e^{-(\\beta _{0}+\\beta _{1}x)}}}}\n  \n\nIn the logistic model, \n  \n    \n      \n        p\n        (\n        x\n        )\n      \n    \n    {\\displaystyle p(x)}\n  \n is interpreted as the probability of the dependent variable \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n  \n equaling a success/case rather than a failure/non-case. It is clear that the response variables \n  \n    \n      \n        \n          Y\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle Y_{i}}\n  \n are not identically distributed: \n  \n    \n      \n        P\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        1\n        ∣\n        X\n        )\n      \n    \n    {\\displaystyle P(Y_{i}=1\\mid X)}\n  \n differs from one data point \n  \n    \n      \n        \n          X\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle X_{i}}\n  \n to another, though they are independent given design matrix \n  \n    \n      \n        X\n      \n    \n    {\\displaystyle X}\n  \n and shared parameters \n  \n    \n      \n        β\n      \n    \n    {\\displaystyle \\beta }\n  \n.\n\n\n=== Definition of the inverse of the logistic function ===\nWe can now define the logit (log odds) function as the inverse \n  \n    \n      \n        g\n        =\n        \n          σ\n          \n            −\n            1\n          \n        \n      \n    \n    {\\displaystyle g=\\sigma ^{-1}}\n  \n of the standard logistic function. It is easy to see that it satisfies:\n\n  \n    \n      \n        g\n        (\n        p\n        (\n        x\n        )\n        )\n        =\n        \n          σ\n          \n            −\n            1\n          \n        \n        (\n        p\n        (\n        x\n        )\n        )\n        =\n        logit\n        ⁡\n        p\n        (\n        x\n        )\n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                p\n                (\n                x\n                )\n              \n              \n                1\n                −\n                p\n                (\n                x\n                )\n              \n            \n          \n          )\n        \n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n        ,\n      \n    \n    {\\displaystyle g(p(x))=\\sigma ^{-1}(p(x))=\\operatorname {logit} p(x)=\\ln \\left({\\frac {p(x)}{1-p(x)}}\\right)=\\beta _{0}+\\beta _{1}x,}\n  \n\nand equivalently, after exponentiating both sides we have the odds:\n\n  \n    \n      \n        \n          \n            \n              p\n              (\n              x\n              )\n            \n            \n              1\n              −\n              p\n              (\n              x\n              )\n            \n          \n        \n        =\n        \n          e\n          \n            \n              β\n              \n                0\n              \n            \n            +\n            \n              β\n              \n                1\n              \n            \n            x\n          \n        \n        .\n      \n    \n    {\\displaystyle {\\frac {p(x)}{1-p(x)}}=e^{\\beta _{0}+\\beta _{1}x}.}\n  \n\n\n=== Interpretation of these terms ===\nIn the above equations, the terms are as follows:\n\n  \n    \n      \n        g\n      \n    \n    {\\displaystyle g}\n  \n is the logit function. The equation for \n  \n    \n      \n        g\n        (\n        p\n        (\n        x\n        )\n        )\n      \n    \n    {\\displaystyle g(p(x))}\n  \n illustrates that the logit (i.e., log-odds or natural logarithm of the odds) is equivalent to the linear regression expression.\n\n  \n    \n      \n        ln\n      \n    \n    {\\displaystyle \\ln }\n  \n denotes the natural logarithm.\n\n  \n    \n      \n        p\n        (\n        x\n        )\n      \n    \n    {\\displaystyle p(x)}\n  \n is the probability that the dependent variable equals a case, given some linear combination of the predictors. The formula for \n  \n    \n      \n        p\n        (\n        x\n        )\n      \n    \n    {\\displaystyle p(x)}\n  \n illustrates that the probability of the dependent variable equaling a case is equal to the value of the logistic function of the linear regression expression. This is important in that it shows that the value of the linear regression expression can vary from negative to positive infinity and yet, after transformation, the resulting expression for the probability \n  \n    \n      \n        p\n        (\n        x\n        )\n      \n    \n    {\\displaystyle p(x)}\n  \n ranges between 0 and 1.\n\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n is the intercept from the linear regression equation (the value of the criterion when the predictor is equal to zero).\n\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle \\beta _{1}x}\n  \n is the regression coefficient multiplied by some value of the predictor.\nbase \n  \n    \n      \n        e\n      \n    \n    {\\displaystyle e}\n  \n denotes the exponential function.\n\n\n=== Definition of the odds ===\nThe odds of the dependent variable equaling a case (given some linear combination \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n of the predictors) is equivalent to the exponential function of the linear regression expression. This illustrates how the logit serves as a link function between the probability and the linear regression expression. Given that the logit ranges between negative and positive infinity, it provides an adequate criterion upon which to conduct linear regression and the logit is easily converted back into the odds.\nSo we define odds of the dependent variable equaling a case (given some linear combination \n  \n    \n      \n        x\n      \n    \n    {\\displaystyle x}\n  \n of the predictors) as follows:\n\n  \n    \n      \n        \n          odds\n        \n        =\n        \n          e\n          \n            \n              β\n              \n                0\n              \n            \n            +\n            \n              β\n              \n                1\n              \n            \n            x\n          \n        \n        .\n      \n    \n    {\\displaystyle {\\text{odds}}=e^{\\beta _{0}+\\beta _{1}x}.}\n  \n\n\n=== The odds ratio ===\nFor a continuous independent variable the odds ratio can be defined as:\n\n  \n    \n      \n        \n          O\n          R\n        \n        =\n        \n          \n            \n              odds\n              ⁡\n              (\n              x\n              +\n              1\n              )\n            \n            \n              odds\n              ⁡\n              (\n              x\n              )\n            \n          \n        \n        =\n        \n          \n            \n              (\n              \n                \n                  \n                    p\n                    (\n                    x\n                    +\n                    1\n                    )\n                  \n                  \n                    1\n                    −\n                    p\n                    (\n                    x\n                    +\n                    1\n                    )\n                  \n                \n              \n              )\n            \n            \n              (\n              \n                \n                  \n                    p\n                    (\n                    x\n                    )\n                  \n                  \n                    1\n                    −\n                    p\n                    (\n                    x\n                    )\n                  \n                \n              \n              )\n            \n          \n        \n        =\n        \n          \n            \n              e\n              \n                \n                  β\n                  \n                    0\n                  \n                \n                +\n                \n                  β\n                  \n                    1\n                  \n                \n                (\n                x\n                +\n                1\n                )\n              \n            \n            \n              e\n              \n                \n                  β\n                  \n                    0\n                  \n                \n                +\n                \n                  β\n                  \n                    1\n                  \n                \n                x\n              \n            \n          \n        \n        =\n        \n          e\n          \n            \n              β\n              \n                1\n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\mathrm {OR} ={\\frac {\\operatorname {odds} (x+1)}{\\operatorname {odds} (x)}}={\\frac {\\left({\\frac {p(x+1)}{1-p(x+1)}}\\right)}{\\left({\\frac {p(x)}{1-p(x)}}\\right)}}={\\frac {e^{\\beta _{0}+\\beta _{1}(x+1)}}{e^{\\beta _{0}+\\beta _{1}x}}}=e^{\\beta _{1}}}\n  \n\nThis exponential relationship provides an interpretation for \n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle \\beta _{1}}\n  \n: The odds multiply by \n  \n    \n      \n        \n          e\n          \n            \n              β\n              \n                1\n              \n            \n          \n        \n      \n    \n    {\\displaystyle e^{\\beta _{1}}}\n  \n for every 1-unit increase in x.\nFor a binary independent variable the odds ratio is defined as \n  \n    \n      \n        \n          \n            \n              a\n              d\n            \n            \n              b\n              c\n            \n          \n        \n      \n    \n    {\\displaystyle {\\frac {ad}{bc}}}\n  \n where a, b, c and d are cells in a 2×2 contingency table.\n\n\n=== Multiple explanatory variables ===\nIf there are multiple explanatory variables, the above expression \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle \\beta _{0}+\\beta _{1}x}\n  \n can be revised to \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        \n          x\n          \n            1\n          \n        \n        +\n        \n          β\n          \n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n        +\n        ⋯\n        +\n        \n          β\n          \n            m\n          \n        \n        \n          x\n          \n            m\n          \n        \n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            m\n          \n        \n        \n          β\n          \n            i\n          \n        \n        \n          x\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}+\\cdots +\\beta _{m}x_{m}=\\beta _{0}+\\sum _{i=1}^{m}\\beta _{i}x_{i}}\n  \n. Then when this is used in the equation relating the log odds of a success to the values of the predictors, the linear regression will be a multiple regression with m explanators; the parameters \n  \n    \n      \n        \n          β\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle \\beta _{i}}\n  \n for all \n  \n    \n      \n        i\n        =\n        0\n        ,\n        1\n        ,\n        2\n        ,\n        …\n        ,\n        m\n      \n    \n    {\\displaystyle i=0,1,2,\\dots ,m}\n  \n are all estimated.\nAgain, the more traditional equations are:\n\n  \n    \n      \n        log\n        ⁡\n        \n          \n            p\n            \n              1\n              −\n              p\n            \n          \n        \n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        \n          x\n          \n            1\n          \n        \n        +\n        \n          β\n          \n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n        +\n        ⋯\n        +\n        \n          β\n          \n            m\n          \n        \n        \n          x\n          \n            m\n          \n        \n      \n    \n    {\\displaystyle \\log {\\frac {p}{1-p}}=\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}+\\cdots +\\beta _{m}x_{m}}\n  \n\nand\n\n  \n    \n      \n        p\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                b\n                \n                  −\n                  (\n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  \n                    x\n                    \n                      1\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      2\n                    \n                  \n                  \n                    x\n                    \n                      2\n                    \n                  \n                  +\n                  ⋯\n                  +\n                  \n                    β\n                    \n                      m\n                    \n                  \n                  \n                    x\n                    \n                      m\n                    \n                  \n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p={\\frac {1}{1+b^{-(\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}+\\cdots +\\beta _{m}x_{m})}}}}\n  \n\nwhere usually \n  \n    \n      \n        b\n        =\n        e\n      \n    \n    {\\displaystyle b=e}\n  \n.\n\n\n== Definition ==\nA dataset contains N points. Each point i consists of a set of m input variables x1,i ... xm,i (also called independent variables, explanatory variables, predictor variables, features, or attributes), and a binary outcome variable Yi (also known as a dependent variable, response variable, output variable, or class), i.e. it can assume only the two possible values 0 (often meaning \"no\" or \"failure\") or 1 (often meaning \"yes\" or \"success\"). The goal of logistic regression is to use the dataset to create a predictive model of the outcome variable.\nAs in linear regression, the outcome variables Yi are assumed to depend on the explanatory variables x1,i ... xm,i.\n\nExplanatory variables\nThe explanatory variables may be of any type: real-valued, binary, categorical, etc.  The main distinction is between continuous variables and discrete variables.\n(Discrete variables referring to more than two possible choices are typically coded using dummy variables (or indicator variables), that is, separate explanatory variables taking the value 0 or 1 are created for each possible value of the discrete variable, with a 1 meaning \"variable does have the given value\" and a 0 meaning \"variable does not have that value\".)\n\nOutcome variables\nFormally, the outcomes Yi are described as being Bernoulli-distributed data, where each outcome is determined by an unobserved probability pi that is specific to the outcome at hand, but related to the explanatory variables.  This can be expressed in any of the following equivalent forms:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  Y\n                  \n                    i\n                  \n                \n                ∣\n                \n                  x\n                  \n                    1\n                    ,\n                    i\n                  \n                \n                ,\n                …\n                ,\n                \n                  x\n                  \n                    m\n                    ,\n                    i\n                  \n                \n                 \n              \n              \n                \n                ∼\n                Bernoulli\n                ⁡\n                (\n                \n                  p\n                  \n                    i\n                  \n                \n                )\n              \n            \n            \n              \n                \n                  \n                    E\n                  \n                \n                ⁡\n                [\n                \n                  Y\n                  \n                    i\n                  \n                \n                ∣\n                \n                  x\n                  \n                    1\n                    ,\n                    i\n                  \n                \n                ,\n                …\n                ,\n                \n                  x\n                  \n                    m\n                    ,\n                    i\n                  \n                \n                ]\n              \n              \n                \n                =\n                \n                  p\n                  \n                    i\n                  \n                \n              \n            \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                y\n                ∣\n                \n                  x\n                  \n                    1\n                    ,\n                    i\n                  \n                \n                ,\n                …\n                ,\n                \n                  x\n                  \n                    m\n                    ,\n                    i\n                  \n                \n                )\n              \n              \n                \n                =\n                \n                  \n                    {\n                    \n                      \n                        \n                          \n                            p\n                            \n                              i\n                            \n                          \n                        \n                        \n                          \n                            if \n                          \n                          y\n                          =\n                          1\n                        \n                      \n                      \n                        \n                          1\n                          −\n                          \n                            p\n                            \n                              i\n                            \n                          \n                        \n                        \n                          \n                            if \n                          \n                          y\n                          =\n                          0\n                        \n                      \n                    \n                    \n                  \n                \n              \n            \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                y\n                ∣\n                \n                  x\n                  \n                    1\n                    ,\n                    i\n                  \n                \n                ,\n                …\n                ,\n                \n                  x\n                  \n                    m\n                    ,\n                    i\n                  \n                \n                )\n              \n              \n                \n                =\n                \n                  p\n                  \n                    i\n                  \n                  \n                    y\n                  \n                \n                (\n                1\n                −\n                \n                  p\n                  \n                    i\n                  \n                \n                \n                  )\n                  \n                    (\n                    1\n                    −\n                    y\n                    )\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}Y_{i}\\mid x_{1,i},\\ldots ,x_{m,i}\\ &\\sim \\operatorname {Bernoulli} (p_{i})\\\\[5pt]\\operatorname {\\mathbb {E} } [Y_{i}\\mid x_{1,i},\\ldots ,x_{m,i}]&=p_{i}\\\\[5pt]\\Pr(Y_{i}=y\\mid x_{1,i},\\ldots ,x_{m,i})&={\\begin{cases}p_{i}&{\\text{if }}y=1\\\\1-p_{i}&{\\text{if }}y=0\\end{cases}}\\\\[5pt]\\Pr(Y_{i}=y\\mid x_{1,i},\\ldots ,x_{m,i})&=p_{i}^{y}(1-p_{i})^{(1-y)}\\end{aligned}}}\n  \n\nThe meanings of these four lines are:\n\nThe first line expresses the probability distribution of each Yi : conditioned on the explanatory variables, it follows a Bernoulli distribution with parameters pi, the probability of the outcome of 1 for trial i. As noted above, each separate trial has its own probability of success, just as each trial has its own explanatory variables.  The probability of success pi is not observed, only the outcome of an individual Bernoulli trial using that probability.\nThe second line expresses the fact that the expected value of each Yi is equal to the probability of success pi, which is a general property of the Bernoulli distribution.  In other words, if we run a large number of Bernoulli trials using the same probability of success pi, then take the average of all the 1 and 0 outcomes, then the result would be close to pi.  This is because doing an average this way simply computes the proportion of successes seen, which we expect to converge to the underlying probability of success.\nThe third line writes out the probability mass function of the Bernoulli distribution, specifying the probability of seeing each of the two possible outcomes.\nThe fourth line is another way of writing the probability mass function, which avoids having to write separate cases and is more convenient for certain types of calculations.  This relies on the fact that Yi can take only the value 0 or 1.  In each case, one of the exponents will be 1, \"choosing\" the value under it, while the other is 0, \"canceling out\" the value under it.  Hence, the outcome is either pi or 1 − pi, as in the previous line.\nLinear predictor function\nThe basic idea of logistic regression is to use the mechanism already developed for linear regression by modeling the probability pi using a linear predictor function, i.e. a linear combination of the explanatory variables and a set of regression coefficients that are specific to the model at hand but the same for all trials.  The linear predictor function \n  \n    \n      \n        f\n        (\n        i\n        )\n      \n    \n    {\\displaystyle f(i)}\n  \n for a particular data point i is written as:\n\n  \n    \n      \n        f\n        (\n        i\n        )\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        \n          x\n          \n            1\n            ,\n            i\n          \n        \n        +\n        ⋯\n        +\n        \n          β\n          \n            m\n          \n        \n        \n          x\n          \n            m\n            ,\n            i\n          \n        \n        ,\n      \n    \n    {\\displaystyle f(i)=\\beta _{0}+\\beta _{1}x_{1,i}+\\cdots +\\beta _{m}x_{m,i},}\n  \n\nwhere \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        ,\n        …\n        ,\n        \n          β\n          \n            m\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0},\\ldots ,\\beta _{m}}\n  \n are regression coefficients indicating the relative effect of a particular explanatory variable on the outcome.\nThe model is usually put into a more compact form as follows:\n\nThe regression coefficients β0, β1, ..., βm are grouped into a single vector β of size m + 1.\nFor each data point i, an additional explanatory pseudo-variable x0,i is added, with a fixed value of 1, corresponding to the intercept coefficient β0.\nThe resulting explanatory variables x0,i, x1,i, ..., xm,i are then grouped into a single vector Xi of size m + 1.\nThis makes it possible to write the linear predictor function as follows:\n\n  \n    \n      \n        f\n        (\n        i\n        )\n        =\n        \n          β\n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        ,\n      \n    \n    {\\displaystyle f(i)={\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i},}\n  \n\nusing the notation for a dot product between two vectors.\n\n\n=== Many explanatory variables, two categories ===\nThe above example of binary logistic regression on one explanatory variable can be generalized to binary logistic regression on any number of explanatory variables x1, x2,... and any number of categorical values \n  \n    \n      \n        y\n        =\n        0\n        ,\n        1\n        ,\n        2\n        ,\n        …\n      \n    \n    {\\displaystyle y=0,1,2,\\dots }\n  \n.\nTo begin with, we may consider a logistic model with M explanatory variables, x1, x2 ... xM and, as in the example above, two categorical values (y = 0 and 1). For the simple binary logistic regression model, we assumed a linear relationship between the predictor variable and the log-odds (also called logit) of the event that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n. This linear relationship may be extended to the case of M explanatory variables:\n\n  \n    \n      \n        t\n        =\n        \n          log\n          \n            b\n          \n        \n        ⁡\n        \n          \n            p\n            \n              1\n              −\n              p\n            \n          \n        \n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        \n          x\n          \n            1\n          \n        \n        +\n        \n          β\n          \n            2\n          \n        \n        \n          x\n          \n            2\n          \n        \n        +\n        ⋯\n        +\n        \n          β\n          \n            M\n          \n        \n        \n          x\n          \n            M\n          \n        \n      \n    \n    {\\displaystyle t=\\log _{b}{\\frac {p}{1-p}}=\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}+\\cdots +\\beta _{M}x_{M}}\n  \n\nwhere t is the log-odds and \n  \n    \n      \n        \n          β\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle \\beta _{i}}\n  \n are parameters of the model. An additional generalization has been introduced in which the base of the model (b) is not restricted to Euler's number e. In most applications, the base \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n of the logarithm is usually taken to be e. However, in some cases it can be easier to communicate results by working in base 2 or base 10.\nFor a more compact notation, we will specify the explanatory variables and the β coefficients as ⁠\n  \n    \n      \n        (\n        M\n        +\n        1\n        )\n      \n    \n    {\\displaystyle (M+1)}\n  \n⁠-dimensional vectors:\n\n  \n    \n      \n        \n          x\n        \n        =\n        {\n        \n          x\n          \n            0\n          \n        \n        ,\n        \n          x\n          \n            1\n          \n        \n        ,\n        \n          x\n          \n            2\n          \n        \n        ,\n        …\n        ,\n        \n          x\n          \n            M\n          \n        \n        }\n      \n    \n    {\\displaystyle {\\boldsymbol {x}}=\\{x_{0},x_{1},x_{2},\\dots ,x_{M}\\}}\n  \n\n  \n    \n      \n        \n          β\n        \n        =\n        {\n        \n          β\n          \n            0\n          \n        \n        ,\n        \n          β\n          \n            1\n          \n        \n        ,\n        \n          β\n          \n            2\n          \n        \n        ,\n        …\n        ,\n        \n          β\n          \n            M\n          \n        \n        }\n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}=\\{\\beta _{0},\\beta _{1},\\beta _{2},\\dots ,\\beta _{M}\\}}\n  \n\nwith an added explanatory variable x0 =1. The logit may now be written as:\n\n  \n    \n      \n        t\n        =\n        \n          ∑\n          \n            m\n            =\n            0\n          \n          \n            M\n          \n        \n        \n          β\n          \n            m\n          \n        \n        \n          x\n          \n            m\n          \n        \n        =\n        \n          β\n        \n        ⋅\n        x\n      \n    \n    {\\displaystyle t=\\sum _{m=0}^{M}\\beta _{m}x_{m}={\\boldsymbol {\\beta }}\\cdot x}\n  \n\nSolving for the probability p that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n yields:\n\n  \n    \n      \n        p\n        (\n        \n          x\n        \n        )\n        =\n        \n          \n            \n              b\n              \n                \n                  β\n                \n                ⋅\n                \n                  x\n                \n              \n            \n            \n              1\n              +\n              \n                b\n                \n                  \n                    β\n                  \n                  ⋅\n                  \n                    x\n                  \n                \n              \n            \n          \n        \n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                b\n                \n                  −\n                  \n                    β\n                  \n                  ⋅\n                  \n                    x\n                  \n                \n              \n            \n          \n        \n        =\n        \n          S\n          \n            b\n          \n        \n        (\n        t\n        )\n      \n    \n    {\\displaystyle p({\\boldsymbol {x}})={\\frac {b^{{\\boldsymbol {\\beta }}\\cdot {\\boldsymbol {x}}}}{1+b^{{\\boldsymbol {\\beta }}\\cdot {\\boldsymbol {x}}}}}={\\frac {1}{1+b^{-{\\boldsymbol {\\beta }}\\cdot {\\boldsymbol {x}}}}}=S_{b}(t)}\n  \n,\nwhere \n  \n    \n      \n        \n          S\n          \n            b\n          \n        \n      \n    \n    {\\displaystyle S_{b}}\n  \n is the sigmoid function with base \n  \n    \n      \n        b\n      \n    \n    {\\displaystyle b}\n  \n. The above formula shows that once the \n  \n    \n      \n        \n          β\n          \n            m\n          \n        \n      \n    \n    {\\displaystyle \\beta _{m}}\n  \n are fixed, we can easily compute either the log-odds that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n for a given observation, or the probability that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n for a given observation. The main use-case of a logistic model is to be given an observation \n  \n    \n      \n        \n          x\n        \n      \n    \n    {\\displaystyle {\\boldsymbol {x}}}\n  \n, and estimate the probability \n  \n    \n      \n        p\n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p({\\boldsymbol {x}})}\n  \n that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n. The optimum beta coefficients may again be found by maximizing the log-likelihood. For K measurements, defining \n  \n    \n      \n        \n          \n            x\n          \n          \n            k\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {x}}_{k}}\n  \n as the explanatory vector of the k-th measurement, and \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle y_{k}}\n  \n as the categorical outcome of that measurement, the log likelihood may be written in a form very similar to the simple \n  \n    \n      \n        M\n        =\n        1\n      \n    \n    {\\displaystyle M=1}\n  \n case above:\n\n  \n    \n      \n        ℓ\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          y\n          \n            k\n          \n        \n        \n          log\n          \n            b\n          \n        \n        ⁡\n        (\n        p\n        (\n        \n          \n            x\n            \n              k\n            \n          \n        \n        )\n        )\n        +\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        1\n        −\n        \n          y\n          \n            k\n          \n        \n        )\n        \n          log\n          \n            b\n          \n        \n        ⁡\n        (\n        1\n        −\n        p\n        (\n        \n          \n            x\n            \n              k\n            \n          \n        \n        )\n        )\n      \n    \n    {\\displaystyle \\ell =\\sum _{k=1}^{K}y_{k}\\log _{b}(p({\\boldsymbol {x_{k}}}))+\\sum _{k=1}^{K}(1-y_{k})\\log _{b}(1-p({\\boldsymbol {x_{k}}}))}\n  \n\nAs in the simple example above, finding the optimum β parameters will require numerical methods. One useful technique is to equate the derivatives of the log likelihood with respect to each of the β parameters to zero yielding a set of equations which will hold at the maximum of the log likelihood:\n\n  \n    \n      \n        \n          \n            \n              ∂\n              ℓ\n            \n            \n              ∂\n              \n                β\n                \n                  m\n                \n              \n            \n          \n        \n        =\n        0\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          y\n          \n            k\n          \n        \n        \n          x\n          \n            m\n            k\n          \n        \n        −\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        p\n        (\n        \n          \n            x\n          \n          \n            k\n          \n        \n        )\n        \n          x\n          \n            m\n            k\n          \n        \n      \n    \n    {\\displaystyle {\\frac {\\partial \\ell }{\\partial \\beta _{m}}}=0=\\sum _{k=1}^{K}y_{k}x_{mk}-\\sum _{k=1}^{K}p({\\boldsymbol {x}}_{k})x_{mk}}\n  \n\nwhere xmk is the value of the xm explanatory variable from the k-th measurement.\nConsider an example with \n  \n    \n      \n        M\n        =\n        2\n      \n    \n    {\\displaystyle M=2}\n  \n explanatory variables, \n  \n    \n      \n        b\n        =\n        10\n      \n    \n    {\\displaystyle b=10}\n  \n, and coefficients \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        =\n        −\n        3\n      \n    \n    {\\displaystyle \\beta _{0}=-3}\n  \n, \n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle \\beta _{1}=1}\n  \n, and \n  \n    \n      \n        \n          β\n          \n            2\n          \n        \n        =\n        2\n      \n    \n    {\\displaystyle \\beta _{2}=2}\n  \n which have been determined by the above method. To be concrete, the model is:\n\n  \n    \n      \n        t\n        =\n        \n          log\n          \n            10\n          \n        \n        ⁡\n        \n          \n            p\n            \n              1\n              −\n              p\n            \n          \n        \n        =\n        −\n        3\n        +\n        \n          x\n          \n            1\n          \n        \n        +\n        2\n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle t=\\log _{10}{\\frac {p}{1-p}}=-3+x_{1}+2x_{2}}\n  \n\n  \n    \n      \n        p\n        =\n        \n          \n            \n              b\n              \n                \n                  β\n                \n                ⋅\n                \n                  x\n                \n              \n            \n            \n              1\n              +\n              \n                b\n                \n                  \n                    β\n                  \n                  ⋅\n                  x\n                \n              \n            \n          \n        \n        =\n        \n          \n            \n              b\n              \n                \n                  β\n                  \n                    0\n                  \n                \n                +\n                \n                  β\n                  \n                    1\n                  \n                \n                \n                  x\n                  \n                    1\n                  \n                \n                +\n                \n                  β\n                  \n                    2\n                  \n                \n                \n                  x\n                  \n                    2\n                  \n                \n              \n            \n            \n              1\n              +\n              \n                b\n                \n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  \n                    x\n                    \n                      1\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      2\n                    \n                  \n                  \n                    x\n                    \n                      2\n                    \n                  \n                \n              \n            \n          \n        \n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                b\n                \n                  −\n                  (\n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  \n                    x\n                    \n                      1\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      2\n                    \n                  \n                  \n                    x\n                    \n                      2\n                    \n                  \n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p={\\frac {b^{{\\boldsymbol {\\beta }}\\cdot {\\boldsymbol {x}}}}{1+b^{{\\boldsymbol {\\beta }}\\cdot x}}}={\\frac {b^{\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}}}{1+b^{\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2}}}}={\\frac {1}{1+b^{-(\\beta _{0}+\\beta _{1}x_{1}+\\beta _{2}x_{2})}}}}\n  \n,\nwhere p is the probability of the event that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n. This can be interpreted as follows:\n\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        =\n        −\n        3\n      \n    \n    {\\displaystyle \\beta _{0}=-3}\n  \n is the y-intercept. It is the log-odds of the event that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n, when the predictors \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n        =\n        \n          x\n          \n            2\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle x_{1}=x_{2}=0}\n  \n. By exponentiating, we can see that when \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n        =\n        \n          x\n          \n            2\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle x_{1}=x_{2}=0}\n  \n the odds of the event that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n are 1-to-1000, or \n  \n    \n      \n        \n          10\n          \n            −\n            3\n          \n        \n      \n    \n    {\\displaystyle 10^{-3}}\n  \n. Similarly, the probability of the event that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n when \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n        =\n        \n          x\n          \n            2\n          \n        \n        =\n        0\n      \n    \n    {\\displaystyle x_{1}=x_{2}=0}\n  \n can be computed as \n  \n    \n      \n        1\n        \n          /\n        \n        (\n        1000\n        +\n        1\n        )\n        =\n        1\n        \n          /\n        \n        1001.\n      \n    \n    {\\displaystyle 1/(1000+1)=1/1001.}\n  \n\n  \n    \n      \n        \n          β\n          \n            1\n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle \\beta _{1}=1}\n  \n means that increasing \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle x_{1}}\n  \n by 1 increases the log-odds by \n  \n    \n      \n        1\n      \n    \n    {\\displaystyle 1}\n  \n. So if \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle x_{1}}\n  \n increases by 1, the odds that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n increase by a factor of \n  \n    \n      \n        \n          10\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle 10^{1}}\n  \n. The probability of \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n has also increased, but it has not increased by as much as the odds have increased.\n\n  \n    \n      \n        \n          β\n          \n            2\n          \n        \n        =\n        2\n      \n    \n    {\\displaystyle \\beta _{2}=2}\n  \n means that increasing \n  \n    \n      \n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle x_{2}}\n  \n by 1 increases the log-odds by \n  \n    \n      \n        2\n      \n    \n    {\\displaystyle 2}\n  \n. So if \n  \n    \n      \n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle x_{2}}\n  \n increases by 1, the odds that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n increase by a factor of \n  \n    \n      \n        \n          10\n          \n            2\n          \n        \n        .\n      \n    \n    {\\displaystyle 10^{2}.}\n  \n Note how the effect of \n  \n    \n      \n        \n          x\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle x_{2}}\n  \n on the log-odds is twice as great as the effect of \n  \n    \n      \n        \n          x\n          \n            1\n          \n        \n      \n    \n    {\\displaystyle x_{1}}\n  \n, but the effect on the odds is 10 times greater. But the effect on the probability of \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n is not as much as 10 times greater, it's only the effect on the odds that is 10 times greater.\n\n\n=== Multinomial logistic regression: Many explanatory variables and many categories ===\n\nIn the above cases of two categories (binomial logistic regression), the categories were indexed by \"0\" and \"1\", and we had two probabilities: The probability that the outcome was in category 1 was given by \n  \n    \n      \n        p\n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p({\\boldsymbol {x}})}\n  \nand the probability that the outcome was in category 0 was given by \n  \n    \n      \n        1\n        −\n        p\n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle 1-p({\\boldsymbol {x}})}\n  \n. The sum of these probabilities equals 1, which must be true, since \"0\" and \"1\" are the only possible categories in this setup.\nIn general, if we have ⁠\n  \n    \n      \n        M\n        +\n        1\n      \n    \n    {\\displaystyle M+1}\n  \n⁠ explanatory variables (including x0) and ⁠\n  \n    \n      \n        N\n        +\n        1\n      \n    \n    {\\displaystyle N+1}\n  \n⁠ categories, we will need ⁠\n  \n    \n      \n        N\n        +\n        1\n      \n    \n    {\\displaystyle N+1}\n  \n⁠ separate probabilities,  one for each category, indexed by n, which describe the probability that the categorical outcome y will be in category y=n, conditional on the vector of covariates x. The sum of these probabilities over all categories must equal 1. Using the mathematically convenient base e, these probabilities are:\n\n  \n    \n      \n        \n          p\n          \n            n\n          \n        \n        (\n        \n          x\n        \n        )\n        =\n        \n          \n            \n              e\n              \n                \n                  \n                    β\n                  \n                  \n                    n\n                  \n                \n                ⋅\n                \n                  x\n                \n              \n            \n            \n              1\n              +\n              \n                ∑\n                \n                  u\n                  =\n                  1\n                \n                \n                  N\n                \n              \n              \n                e\n                \n                  \n                    \n                      β\n                    \n                    \n                      u\n                    \n                  \n                  ⋅\n                  \n                    x\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p_{n}({\\boldsymbol {x}})={\\frac {e^{{\\boldsymbol {\\beta }}_{n}\\cdot {\\boldsymbol {x}}}}{1+\\sum _{u=1}^{N}e^{{\\boldsymbol {\\beta }}_{u}\\cdot {\\boldsymbol {x}}}}}}\n  \n for \n  \n    \n      \n        n\n        =\n        1\n        ,\n        2\n        ,\n        …\n        ,\n        N\n      \n    \n    {\\displaystyle n=1,2,\\dots ,N}\n  \n\n  \n    \n      \n        \n          p\n          \n            0\n          \n        \n        (\n        \n          x\n        \n        )\n        =\n        1\n        −\n        \n          ∑\n          \n            n\n            =\n            1\n          \n          \n            N\n          \n        \n        \n          p\n          \n            n\n          \n        \n        (\n        \n          x\n        \n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                ∑\n                \n                  u\n                  =\n                  1\n                \n                \n                  N\n                \n              \n              \n                e\n                \n                  \n                    \n                      β\n                    \n                    \n                      u\n                    \n                  \n                  ⋅\n                  \n                    x\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p_{0}({\\boldsymbol {x}})=1-\\sum _{n=1}^{N}p_{n}({\\boldsymbol {x}})={\\frac {1}{1+\\sum _{u=1}^{N}e^{{\\boldsymbol {\\beta }}_{u}\\cdot {\\boldsymbol {x}}}}}}\n  \n\nEach of the probabilities except \n  \n    \n      \n        \n          p\n          \n            0\n          \n        \n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p_{0}({\\boldsymbol {x}})}\n  \n will have their own set of regression coefficients \n  \n    \n      \n        \n          \n            β\n          \n          \n            n\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}_{n}}\n  \n.  It can be seen that, as required, the sum of the \n  \n    \n      \n        \n          p\n          \n            n\n          \n        \n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p_{n}({\\boldsymbol {x}})}\n  \n over all categories n is 1. The selection of \n  \n    \n      \n        \n          p\n          \n            0\n          \n        \n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p_{0}({\\boldsymbol {x}})}\n  \n to be defined in terms of the other probabilities is artificial. Any of the probabilities could have been selected to be so defined. This special value of n is termed the \"pivot index\", and the log-odds (tn) are expressed in terms of the pivot probability and are again expressed as a linear combination of the explanatory variables:\n\n  \n    \n      \n        \n          t\n          \n            n\n          \n        \n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                \n                  p\n                  \n                    n\n                  \n                \n                (\n                \n                  x\n                \n                )\n              \n              \n                \n                  p\n                  \n                    0\n                  \n                \n                (\n                \n                  x\n                \n                )\n              \n            \n          \n          )\n        \n        =\n        \n          \n            β\n          \n          \n            n\n          \n        \n        ⋅\n        \n          x\n        \n      \n    \n    {\\displaystyle t_{n}=\\ln \\left({\\frac {p_{n}({\\boldsymbol {x}})}{p_{0}({\\boldsymbol {x}})}}\\right)={\\boldsymbol {\\beta }}_{n}\\cdot {\\boldsymbol {x}}}\n  \n\nNote also that for the simple case of \n  \n    \n      \n        N\n        =\n        1\n      \n    \n    {\\displaystyle N=1}\n  \n, the two-category case is recovered, with \n  \n    \n      \n        p\n        (\n        \n          x\n        \n        )\n        =\n        \n          p\n          \n            1\n          \n        \n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p({\\boldsymbol {x}})=p_{1}({\\boldsymbol {x}})}\n  \n and \n  \n    \n      \n        \n          p\n          \n            0\n          \n        \n        (\n        \n          x\n        \n        )\n        =\n        1\n        −\n        \n          p\n          \n            1\n          \n        \n        (\n        \n          x\n        \n        )\n      \n    \n    {\\displaystyle p_{0}({\\boldsymbol {x}})=1-p_{1}({\\boldsymbol {x}})}\n  \n.\nThe log-likelihood that a particular set of K measurements or data points will be generated by the above probabilities can now be calculated. Indexing each measurement by k, let the k-th set of measured explanatory variables be denoted by \n  \n    \n      \n        \n          \n            x\n          \n          \n            k\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {x}}_{k}}\n  \n and their categorical outcomes be denoted by \n  \n    \n      \n        \n          y\n          \n            k\n          \n        \n      \n    \n    {\\displaystyle y_{k}}\n  \n which can be equal to any integer in [0,N]. The log-likelihood is then:\n\n  \n    \n      \n        ℓ\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          ∑\n          \n            n\n            =\n            0\n          \n          \n            N\n          \n        \n        Δ\n        (\n        n\n        ,\n        \n          y\n          \n            k\n          \n        \n        )\n        \n        ln\n        ⁡\n        (\n        \n          p\n          \n            n\n          \n        \n        (\n        \n          \n            x\n          \n          \n            k\n          \n        \n        )\n        )\n      \n    \n    {\\displaystyle \\ell =\\sum _{k=1}^{K}\\sum _{n=0}^{N}\\Delta (n,y_{k})\\,\\ln(p_{n}({\\boldsymbol {x}}_{k}))}\n  \n\nwhere \n  \n    \n      \n        Δ\n        (\n        n\n        ,\n        \n          y\n          \n            k\n          \n        \n        )\n      \n    \n    {\\displaystyle \\Delta (n,y_{k})}\n  \n is an indicator function which equals 1 if yk = n and zero otherwise. In the case of two explanatory variables, this indicator function was defined as yk when n = 1 and 1-yk when n = 0. This was convenient, but not necessary. Again, the optimum beta coefficients may be found by maximizing the log-likelihood function generally using numerical methods. A possible method of solution is to set the derivatives of the log-likelihood with respect to each beta coefficient equal to zero and solve for the beta coefficients:\n\n  \n    \n      \n        \n          \n            \n              ∂\n              ℓ\n            \n            \n              ∂\n              \n                β\n                \n                  n\n                  m\n                \n              \n            \n          \n        \n        =\n        0\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        Δ\n        (\n        n\n        ,\n        \n          y\n          \n            k\n          \n        \n        )\n        \n          x\n          \n            m\n            k\n          \n        \n        −\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          p\n          \n            n\n          \n        \n        (\n        \n          \n            x\n          \n          \n            k\n          \n        \n        )\n        \n          x\n          \n            m\n            k\n          \n        \n      \n    \n    {\\displaystyle {\\frac {\\partial \\ell }{\\partial \\beta _{nm}}}=0=\\sum _{k=1}^{K}\\Delta (n,y_{k})x_{mk}-\\sum _{k=1}^{K}p_{n}({\\boldsymbol {x}}_{k})x_{mk}}\n  \n\nwhere \n  \n    \n      \n        \n          β\n          \n            n\n            m\n          \n        \n      \n    \n    {\\displaystyle \\beta _{nm}}\n  \n is the m-th coefficient of the \n  \n    \n      \n        \n          \n            β\n          \n          \n            n\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}_{n}}\n  \n vector and \n  \n    \n      \n        \n          x\n          \n            m\n            k\n          \n        \n      \n    \n    {\\displaystyle x_{mk}}\n  \n is the m-th explanatory variable of the k-th measurement. Once the beta coefficients have been estimated from the data, we will be able to estimate the probability that any subsequent set of explanatory variables will result in any of the possible outcome categories.\n\n\n== Interpretations ==\nThere are various equivalent specifications and interpretations of logistic regression, which fit into different types of more general models, and allow different generalizations.\n\n\n=== As a generalized linear model ===\nThe particular model used by logistic regression, which distinguishes it from standard linear regression and from other types of regression analysis used for binary-valued outcomes, is the way the probability of a particular outcome is linked to the linear predictor function:\n\n  \n    \n      \n        logit\n        ⁡\n        (\n        \n          \n            E\n          \n        \n        ⁡\n        [\n        \n          Y\n          \n            i\n          \n        \n        ∣\n        \n          x\n          \n            1\n            ,\n            i\n          \n        \n        ,\n        …\n        ,\n        \n          x\n          \n            m\n            ,\n            i\n          \n        \n        ]\n        )\n        =\n        logit\n        ⁡\n        (\n        \n          p\n          \n            i\n          \n        \n        )\n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                p\n                \n                  i\n                \n              \n              \n                1\n                −\n                \n                  p\n                  \n                    i\n                  \n                \n              \n            \n          \n          )\n        \n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        \n          x\n          \n            1\n            ,\n            i\n          \n        \n        +\n        ⋯\n        +\n        \n          β\n          \n            m\n          \n        \n        \n          x\n          \n            m\n            ,\n            i\n          \n        \n      \n    \n    {\\displaystyle \\operatorname {logit} (\\operatorname {\\mathbb {E} } [Y_{i}\\mid x_{1,i},\\ldots ,x_{m,i}])=\\operatorname {logit} (p_{i})=\\ln \\left({\\frac {p_{i}}{1-p_{i}}}\\right)=\\beta _{0}+\\beta _{1}x_{1,i}+\\cdots +\\beta _{m}x_{m,i}}\n  \n\nWritten using the more compact notation described above, this is:\n\n  \n    \n      \n        logit\n        ⁡\n        (\n        \n          \n            E\n          \n        \n        ⁡\n        [\n        \n          Y\n          \n            i\n          \n        \n        ∣\n        \n          \n            X\n          \n          \n            i\n          \n        \n        ]\n        )\n        =\n        logit\n        ⁡\n        (\n        \n          p\n          \n            i\n          \n        \n        )\n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                p\n                \n                  i\n                \n              \n              \n                1\n                −\n                \n                  p\n                  \n                    i\n                  \n                \n              \n            \n          \n          )\n        \n        =\n        \n          β\n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n      \n    \n    {\\displaystyle \\operatorname {logit} (\\operatorname {\\mathbb {E} } [Y_{i}\\mid \\mathbf {X} _{i}])=\\operatorname {logit} (p_{i})=\\ln \\left({\\frac {p_{i}}{1-p_{i}}}\\right)={\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}\n  \n\nThis formulation expresses logistic regression as a type of generalized linear model, which predicts variables with various types of probability distributions by fitting a linear predictor function of the above form to some sort of arbitrary transformation of the expected value of the variable.\nThe intuition for transforming using the logit function (the natural log of the odds) was explained above.  It also has the practical effect of converting the probability (which is bounded to be between 0 and 1) to a variable that ranges over \n  \n    \n      \n        (\n        −\n        ∞\n        ,\n        +\n        ∞\n        )\n      \n    \n    {\\displaystyle (-\\infty ,+\\infty )}\n  \n — thereby matching the potential range of the linear prediction function on the right side of the equation.\nBoth the probabilities pi and the regression coefficients are unobserved, and the means of determining them is not part of the model itself.  They are typically determined by some sort of optimization procedure, e.g. maximum likelihood estimation, that finds values that best fit the observed data (i.e. that give the most accurate predictions for the data already observed), usually subject to regularization conditions that seek to exclude unlikely values, e.g. extremely large values for any of the regression coefficients.  The use of a regularization condition is equivalent to doing maximum a posteriori (MAP) estimation, an extension of maximum likelihood.  (Regularization is most commonly done using a squared regularizing function, which is equivalent to placing a zero-mean Gaussian prior distribution on the coefficients, but other regularizers are also possible.)  Whether or not regularization is used, it is usually not possible to find a closed-form solution; instead, an iterative numerical method must be used, such as iteratively reweighted least squares (IRLS) or, more commonly these days, a quasi-Newton method such as the L-BFGS method.\nThe interpretation of the βj parameter estimates is as the additive effect on the log of the odds for a unit change in the j the explanatory variable.  In the case of a dichotomous explanatory variable, for instance, gender \n  \n    \n      \n        \n          e\n          \n            β\n          \n        \n      \n    \n    {\\displaystyle e^{\\beta }}\n  \n is the estimate of the odds of having the outcome for, say, males compared with females.\nAn equivalent formula uses the inverse of the logit function, which is the logistic function, i.e.:\n\n  \n    \n      \n        \n          \n            E\n          \n        \n        ⁡\n        [\n        \n          Y\n          \n            i\n          \n        \n        ∣\n        \n          \n            X\n          \n          \n            i\n          \n        \n        ]\n        =\n        \n          p\n          \n            i\n          \n        \n        =\n        \n          logit\n          \n            −\n            1\n          \n        \n        ⁡\n        (\n        \n          β\n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  \n                    β\n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\operatorname {\\mathbb {E} } [Y_{i}\\mid \\mathbf {X} _{i}]=p_{i}=\\operatorname {logit} ^{-1}({\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})={\\frac {1}{1+e^{-{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}}\n  \n\nThe formula can also be written as a probability distribution (specifically, using a probability mass function):\n\n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        y\n        ∣\n        \n          \n            X\n          \n          \n            i\n          \n        \n        )\n        =\n        \n          \n            \n              p\n              \n                i\n              \n            \n          \n          \n            y\n          \n        \n        (\n        1\n        −\n        \n          p\n          \n            i\n          \n        \n        \n          )\n          \n            1\n            −\n            y\n          \n        \n        =\n        \n          \n            (\n            \n              \n                \n                  e\n                  \n                    \n                      β\n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                  \n                \n                \n                  1\n                  +\n                  \n                    e\n                    \n                      \n                        β\n                      \n                      ⋅\n                      \n                        \n                          X\n                        \n                        \n                          i\n                        \n                      \n                    \n                  \n                \n              \n            \n            )\n          \n          \n            y\n          \n        \n        \n          \n            (\n            \n              1\n              −\n              \n                \n                  \n                    e\n                    \n                      \n                        β\n                      \n                      ⋅\n                      \n                        \n                          X\n                        \n                        \n                          i\n                        \n                      \n                    \n                  \n                  \n                    1\n                    +\n                    \n                      e\n                      \n                        \n                          β\n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                  \n                \n              \n            \n            )\n          \n          \n            1\n            −\n            y\n          \n        \n        =\n        \n          \n            \n              e\n              \n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                ⋅\n                y\n              \n            \n            \n              1\n              +\n              \n                e\n                \n                  \n                    β\n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\Pr(Y_{i}=y\\mid \\mathbf {X} _{i})={p_{i}}^{y}(1-p_{i})^{1-y}=\\left({\\frac {e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}{1+e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}\\right)^{y}\\left(1-{\\frac {e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}{1+e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}\\right)^{1-y}={\\frac {e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}\\cdot y}}{1+e^{{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}}\n  \n\n\n=== As a latent-variable model ===\nThe logistic model has an equivalent formulation as a latent-variable model.  This formulation is common in the theory of discrete choice models and makes it easier to extend to certain more complicated models with multiple, correlated choices, as well as to compare logistic regression to the closely related probit model.\nImagine that, for each trial i, there is a continuous latent variable Yi* (i.e. an unobserved random variable) that is distributed as follows:\n\n  \n    \n      \n        \n          Y\n          \n            i\n          \n          \n            ∗\n          \n        \n        =\n        \n          β\n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        +\n        \n          ε\n          \n            i\n          \n        \n        \n      \n    \n    {\\displaystyle Y_{i}^{\\ast }={\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}+\\varepsilon _{i}\\,}\n  \n\nwhere\n\n  \n    \n      \n        \n          ε\n          \n            i\n          \n        \n        ∼\n        Logistic\n        ⁡\n        (\n        0\n        ,\n        1\n        )\n        \n      \n    \n    {\\displaystyle \\varepsilon _{i}\\sim \\operatorname {Logistic} (0,1)\\,}\n  \n\ni.e. the latent variable can be written directly in terms of the linear predictor function and an additive random error variable that is distributed according to a standard logistic distribution.\nThen Yi can be viewed as an indicator for whether this latent variable is positive:\n\n  \n    \n      \n        \n          Y\n          \n            i\n          \n        \n        =\n        \n          \n            {\n            \n              \n                \n                  1\n                \n                \n                  \n                    if \n                  \n                  \n                    Y\n                    \n                      i\n                    \n                    \n                      ∗\n                    \n                  \n                  >\n                  0\n                   \n                  \n                     i.e. \n                  \n                  \n                    −\n                    \n                      ε\n                      \n                        i\n                      \n                    \n                  \n                  <\n                  \n                    β\n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                  ,\n                \n              \n              \n                \n                  0\n                \n                \n                  \n                    otherwise.\n                  \n                \n              \n            \n            \n          \n        \n      \n    \n    {\\displaystyle Y_{i}={\\begin{cases}1&{\\text{if }}Y_{i}^{\\ast }>0\\ {\\text{ i.e. }}{-\\varepsilon _{i}}<{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i},\\\\0&{\\text{otherwise.}}\\end{cases}}}\n  \n\nThe choice of modeling the error variable specifically with a standard logistic distribution, rather than a general logistic distribution with the location and scale set to arbitrary values, seems restrictive, but in fact, it is not.  It must be kept in mind that we can choose the regression coefficients ourselves, and very often can use them to offset changes in the parameters of the error variable's distribution.  For example, a logistic error-variable distribution with a non-zero location parameter μ (which sets the mean) is equivalent to a distribution with a zero location parameter, where μ has been added to the intercept coefficient.  Both situations produce the same value for Yi* regardless of settings of explanatory variables.  Similarly, an arbitrary scale parameter s is equivalent to setting the scale parameter to 1 and then dividing all regression coefficients by s.  In the latter case, the resulting value of Yi* will be smaller by a factor of s than in the former case, for all sets of explanatory variables — but critically, it will always remain on the same side of 0, and hence lead to the same Yi choice.\n(This predicts that the irrelevancy of the scale parameter may not carry over into more complex models where more than two choices are available.)\nIt turns out that this formulation is exactly equivalent to the preceding one, phrased in terms of the generalized linear model and without any latent variables.  This can be shown as follows, using the fact that the cumulative distribution function (CDF) of the standard logistic distribution is the logistic function, which is the inverse of the logit function, i.e.\n\n  \n    \n      \n        Pr\n        (\n        \n          ε\n          \n            i\n          \n        \n        <\n        x\n        )\n        =\n        \n          logit\n          \n            −\n            1\n          \n        \n        ⁡\n        (\n        x\n        )\n      \n    \n    {\\displaystyle \\Pr(\\varepsilon _{i}<x)=\\operatorname {logit} ^{-1}(x)}\n  \n\nThen:\n\n  \n    \n      \n        \n          \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                ∣\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n              \n                \n                =\n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                  \n                    ∗\n                  \n                \n                >\n                0\n                ∣\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n            \n            \n              \n              \n                \n                =\n                Pr\n                (\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                \n                  ε\n                  \n                    i\n                  \n                \n                >\n                0\n                )\n              \n            \n            \n              \n              \n                \n                =\n                Pr\n                (\n                \n                  ε\n                  \n                    i\n                  \n                \n                >\n                −\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n            \n            \n              \n              \n                \n                =\n                Pr\n                (\n                \n                  ε\n                  \n                    i\n                  \n                \n                <\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n              \n              \n                \n                  (because the logistic distribution is symmetric)\n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  logit\n                  \n                    −\n                    1\n                  \n                \n                ⁡\n                (\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n              \n            \n            \n              \n              \n                \n                =\n                \n                  p\n                  \n                    i\n                  \n                \n              \n              \n              \n                \n                  (see above)\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\Pr(Y_{i}=1\\mid \\mathbf {X} _{i})&=\\Pr(Y_{i}^{\\ast }>0\\mid \\mathbf {X} _{i})\\\\[5pt]&=\\Pr({\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}+\\varepsilon _{i}>0)\\\\[5pt]&=\\Pr(\\varepsilon _{i}>-{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})\\\\[5pt]&=\\Pr(\\varepsilon _{i}<{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})&&{\\text{(because the logistic distribution is symmetric)}}\\\\[5pt]&=\\operatorname {logit} ^{-1}({\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})&\\\\[5pt]&=p_{i}&&{\\text{(see above)}}\\end{aligned}}}\n  \n\nThis formulation—which is standard in discrete choice models—makes clear the relationship between logistic regression (the \"logit model\") and the probit model, which uses an error variable distributed according to a standard normal distribution instead of a standard logistic distribution.  Both the logistic and normal distributions are symmetric with a basic unimodal, \"bell curve\" shape.  The only difference is that the logistic distribution has somewhat heavier tails, which means that it is less sensitive to outlying data (and hence somewhat more robust to model mis-specifications or erroneous data).\n\n\n=== Two-way latent-variable model ===\nYet another formulation uses two separate latent variables:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  Y\n                  \n                    i\n                  \n                  \n                    0\n                    ∗\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    β\n                  \n                  \n                    0\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                \n                  ε\n                  \n                    0\n                  \n                \n                \n              \n            \n            \n              \n                \n                  Y\n                  \n                    i\n                  \n                  \n                    1\n                    ∗\n                  \n                \n              \n              \n                \n                =\n                \n                  \n                    β\n                  \n                  \n                    1\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                \n                  ε\n                  \n                    1\n                  \n                \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}Y_{i}^{0\\ast }&={\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}+\\varepsilon _{0}\\,\\\\Y_{i}^{1\\ast }&={\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}+\\varepsilon _{1}\\,\\end{aligned}}}\n  \n\nwhere\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  ε\n                  \n                    0\n                  \n                \n              \n              \n                \n                ∼\n                \n                  EV\n                  \n                    1\n                  \n                \n                ⁡\n                (\n                0\n                ,\n                1\n                )\n              \n            \n            \n              \n                \n                  ε\n                  \n                    1\n                  \n                \n              \n              \n                \n                ∼\n                \n                  EV\n                  \n                    1\n                  \n                \n                ⁡\n                (\n                0\n                ,\n                1\n                )\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\varepsilon _{0}&\\sim \\operatorname {EV} _{1}(0,1)\\\\\\varepsilon _{1}&\\sim \\operatorname {EV} _{1}(0,1)\\end{aligned}}}\n  \n\nwhere EV1(0,1) is a standard type-1 extreme value distribution: i.e.\n\n  \n    \n      \n        Pr\n        (\n        \n          ε\n          \n            0\n          \n        \n        =\n        x\n        )\n        =\n        Pr\n        (\n        \n          ε\n          \n            1\n          \n        \n        =\n        x\n        )\n        =\n        \n          e\n          \n            −\n            x\n          \n        \n        \n          e\n          \n            −\n            \n              e\n              \n                −\n                x\n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\Pr(\\varepsilon _{0}=x)=\\Pr(\\varepsilon _{1}=x)=e^{-x}e^{-e^{-x}}}\n  \n\nThen\n\n  \n    \n      \n        \n          Y\n          \n            i\n          \n        \n        =\n        \n          \n            {\n            \n              \n                \n                  1\n                \n                \n                  \n                    if \n                  \n                  \n                    Y\n                    \n                      i\n                    \n                    \n                      1\n                      ∗\n                    \n                  \n                  >\n                  \n                    Y\n                    \n                      i\n                    \n                    \n                      0\n                      ∗\n                    \n                  \n                  ,\n                \n              \n              \n                \n                  0\n                \n                \n                  \n                    otherwise.\n                  \n                \n              \n            \n            \n          \n        \n      \n    \n    {\\displaystyle Y_{i}={\\begin{cases}1&{\\text{if }}Y_{i}^{1\\ast }>Y_{i}^{0\\ast },\\\\0&{\\text{otherwise.}}\\end{cases}}}\n  \n\nThis model has a separate latent variable and a separate set of regression coefficients for each possible outcome of the dependent variable.  The reason for this separation is that it makes it easy to extend logistic regression to multi-outcome categorical variables, as in the multinomial logit model. In such a model, it is natural to model each possible outcome using a different set of regression coefficients.  It is also possible to motivate each of the separate latent variables as the theoretical utility associated with making the associated choice, and thus motivate logistic regression in terms of utility theory. (In terms of utility theory, a rational actor always chooses the choice with the greatest associated utility.) This is the approach taken by economists when formulating discrete choice models, because it both provides a theoretically strong foundation and facilitates intuitions about the model, which in turn makes it easy to consider various sorts of extensions. (See the example below.)\nThe choice of the type-1 extreme value distribution seems fairly arbitrary, but it makes the mathematics work out, and it may be possible to justify its use through rational choice theory.\nIt turns out that this model is equivalent to the previous model, although this seems non-obvious, since there are now two sets of regression coefficients and error variables, and the error variables have a different distribution.  In fact, this model reduces directly to the previous one with the following substitutions:\n\n  \n    \n      \n        \n          β\n        \n        =\n        \n          \n            β\n          \n          \n            1\n          \n        \n        −\n        \n          \n            β\n          \n          \n            0\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}={\\boldsymbol {\\beta }}_{1}-{\\boldsymbol {\\beta }}_{0}}\n  \n\n  \n    \n      \n        ε\n        =\n        \n          ε\n          \n            1\n          \n        \n        −\n        \n          ε\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\varepsilon =\\varepsilon _{1}-\\varepsilon _{0}}\n  \n\nAn intuition for this comes from the fact that, since we choose based on the maximum of two values, only their difference matters, not the exact values — and this effectively removes one degree of freedom. Another critical fact is that the difference of two type-1 extreme-value-distributed variables is a logistic distribution, i.e. \n  \n    \n      \n        ε\n        =\n        \n          ε\n          \n            1\n          \n        \n        −\n        \n          ε\n          \n            0\n          \n        \n        ∼\n        Logistic\n        ⁡\n        (\n        0\n        ,\n        1\n        )\n        .\n      \n    \n    {\\displaystyle \\varepsilon =\\varepsilon _{1}-\\varepsilon _{0}\\sim \\operatorname {Logistic} (0,1).}\n  \n We can demonstrate the equivalent as follows:\n\n  \n    \n      \n        \n          \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                ∣\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n                =\n                \n\n                \n              \n              \n                \n                Pr\n                \n                  (\n                  \n                    \n                      Y\n                      \n                        i\n                      \n                      \n                        1\n                        ∗\n                      \n                    \n                    >\n                    \n                      Y\n                      \n                        i\n                      \n                      \n                        0\n                        ∗\n                      \n                    \n                    ∣\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                  \n                  )\n                \n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                \n                  (\n                  \n                    \n                      Y\n                      \n                        i\n                      \n                      \n                        1\n                        ∗\n                      \n                    \n                    −\n                    \n                      Y\n                      \n                        i\n                      \n                      \n                        0\n                        ∗\n                      \n                    \n                    >\n                    0\n                    ∣\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                  \n                  )\n                \n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                \n                  (\n                  \n                    \n                      \n                        β\n                      \n                      \n                        1\n                      \n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                    +\n                    \n                      ε\n                      \n                        1\n                      \n                    \n                    −\n                    \n                      (\n                      \n                        \n                          \n                            β\n                          \n                          \n                            0\n                          \n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                        +\n                        \n                          ε\n                          \n                            0\n                          \n                        \n                      \n                      )\n                    \n                    >\n                    0\n                  \n                  )\n                \n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                \n                  (\n                  \n                    (\n                    \n                      \n                        β\n                      \n                      \n                        1\n                      \n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                    −\n                    \n                      \n                        β\n                      \n                      \n                        0\n                      \n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                    )\n                    +\n                    (\n                    \n                      ε\n                      \n                        1\n                      \n                    \n                    −\n                    \n                      ε\n                      \n                        0\n                      \n                    \n                    )\n                    >\n                    0\n                  \n                  )\n                \n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                (\n                (\n                \n                  \n                    β\n                  \n                  \n                    1\n                  \n                \n                −\n                \n                  \n                    β\n                  \n                  \n                    0\n                  \n                \n                )\n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                (\n                \n                  ε\n                  \n                    1\n                  \n                \n                −\n                \n                  ε\n                  \n                    0\n                  \n                \n                )\n                >\n                0\n                )\n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                (\n                (\n                \n                  \n                    β\n                  \n                  \n                    1\n                  \n                \n                −\n                \n                  \n                    β\n                  \n                  \n                    0\n                  \n                \n                )\n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                ε\n                >\n                0\n                )\n              \n              \n              \n                \n                  (substitute \n                \n                ε\n                \n                   as above)\n                \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                (\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                +\n                ε\n                >\n                0\n                )\n              \n              \n              \n                \n                  (substitute \n                \n                \n                  β\n                \n                \n                   as above)\n                \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                (\n                ε\n                >\n                −\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n              \n              \n                \n                  (now, same as above model)\n                \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                Pr\n                (\n                ε\n                <\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                  logit\n                  \n                    −\n                    1\n                  \n                \n                ⁡\n                (\n                \n                  β\n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                )\n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                  p\n                  \n                    i\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\Pr(Y_{i}=1\\mid \\mathbf {X} _{i})={}&\\Pr \\left(Y_{i}^{1\\ast }>Y_{i}^{0\\ast }\\mid \\mathbf {X} _{i}\\right)&\\\\[5pt]={}&\\Pr \\left(Y_{i}^{1\\ast }-Y_{i}^{0\\ast }>0\\mid \\mathbf {X} _{i}\\right)&\\\\[5pt]={}&\\Pr \\left({\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}+\\varepsilon _{1}-\\left({\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}+\\varepsilon _{0}\\right)>0\\right)&\\\\[5pt]={}&\\Pr \\left(({\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}-{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i})+(\\varepsilon _{1}-\\varepsilon _{0})>0\\right)&\\\\[5pt]={}&\\Pr(({\\boldsymbol {\\beta }}_{1}-{\\boldsymbol {\\beta }}_{0})\\cdot \\mathbf {X} _{i}+(\\varepsilon _{1}-\\varepsilon _{0})>0)&\\\\[5pt]={}&\\Pr(({\\boldsymbol {\\beta }}_{1}-{\\boldsymbol {\\beta }}_{0})\\cdot \\mathbf {X} _{i}+\\varepsilon >0)&&{\\text{(substitute }}\\varepsilon {\\text{ as above)}}\\\\[5pt]={}&\\Pr({\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}+\\varepsilon >0)&&{\\text{(substitute }}{\\boldsymbol {\\beta }}{\\text{ as above)}}\\\\[5pt]={}&\\Pr(\\varepsilon >-{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})&&{\\text{(now, same as above model)}}\\\\[5pt]={}&\\Pr(\\varepsilon <{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})&\\\\[5pt]={}&\\operatorname {logit} ^{-1}({\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i})\\\\[5pt]={}&p_{i}\\end{aligned}}}\n  \n\n\n==== Example ====\n\nAs an example, consider a province-level election where the choice is between a right-of-center party, a left-of-center party, and a secessionist party (e.g. the Parti Québécois, which wants Quebec to secede from Canada).  We would then use three latent variables, one for each choice.  Then, in accordance with utility theory, we can then interpret the latent variables as expressing the utility that results from making each of the choices.  We can also interpret the regression coefficients as indicating the strength that the associated factor (i.e. explanatory variable) has in contributing to the utility — or more correctly, the amount by which a unit change in an explanatory variable changes the utility of a given choice.  A voter might expect that the right-of-center party would lower taxes, especially on rich people.  This would give low-income people no benefit, i.e. no change in utility (since they usually don't pay taxes); would cause moderate benefit (i.e. somewhat more money, or moderate utility increase) for middle-incoming people; would cause significant benefits for high-income people.  On the other hand, the left-of-center party might be expected to raise taxes and offset it with increased welfare and other assistance for the lower and middle classes.  This would cause significant positive benefit to low-income people, perhaps a weak benefit to middle-income people, and significant negative benefit to high-income people.  Finally, the secessionist party would take no direct actions on the economy, but simply secede. A low-income or middle-income voter might expect basically no clear utility gain or loss from this, but a high-income voter might expect negative utility since he/she is likely to own companies, which will have a harder time doing business in such an environment and probably lose money.\nThese intuitions can be expressed as follows:\n\nThis clearly shows that\n\nSeparate sets of regression coefficients need to exist for each choice.  When phrased in terms of utility, this can be seen very easily. Different choices have different effects on net utility; furthermore, the effects vary in complex ways that depend on the characteristics of each individual, so there need to be separate sets of coefficients for each characteristic, not simply a single extra per-choice characteristic.\nEven though income is a continuous variable, its effect on utility is too complex for it to be treated as a single variable.  Either it needs to be directly split up into ranges, or higher powers of income need to be added so that polynomial regression on income is effectively done.\n\n\n=== As a \"log-linear\" model ===\nYet another formulation combines the two-way latent variable formulation above with the original formulation higher up without latent variables, and in the process provides a link to one of the standard formulations of the multinomial logit.\nHere, instead of writing the logit of the probabilities pi as a linear predictor, we separate the linear predictor into two, one for each of the two outcomes:\n\n  \n    \n      \n        \n          \n            \n              \n                ln\n                ⁡\n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                0\n                )\n              \n              \n                \n                =\n                \n                  \n                    β\n                  \n                  \n                    0\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                −\n                ln\n                ⁡\n                Z\n              \n            \n            \n              \n                ln\n                ⁡\n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                )\n              \n              \n                \n                =\n                \n                  \n                    β\n                  \n                  \n                    1\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n                −\n                ln\n                ⁡\n                Z\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\ln \\Pr(Y_{i}=0)&={\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}-\\ln Z\\\\\\ln \\Pr(Y_{i}=1)&={\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}-\\ln Z\\end{aligned}}}\n  \n\nTwo separate sets of regression coefficients have been introduced, just as in the two-way latent variable model, and the two equations appear a form that writes the logarithm of the associated probability as a linear predictor, with an extra term \n  \n    \n      \n        −\n        ln\n        ⁡\n        Z\n      \n    \n    {\\displaystyle -\\ln Z}\n  \n at the end.  This term, as it turns out, serves as the normalizing factor ensuring that the result is a distribution.  This can be seen by exponentiating both sides:\n\n  \n    \n      \n        \n          \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                0\n                )\n              \n              \n                \n                =\n                \n                  \n                    1\n                    Z\n                  \n                \n                \n                  e\n                  \n                    \n                      \n                        β\n                      \n                      \n                        0\n                      \n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                  \n                \n              \n            \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                )\n              \n              \n                \n                =\n                \n                  \n                    1\n                    Z\n                  \n                \n                \n                  e\n                  \n                    \n                      \n                        β\n                      \n                      \n                        1\n                      \n                    \n                    ⋅\n                    \n                      \n                        X\n                      \n                      \n                        i\n                      \n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\Pr(Y_{i}=0)&={\\frac {1}{Z}}e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}\\\\[5pt]\\Pr(Y_{i}=1)&={\\frac {1}{Z}}e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}\\end{aligned}}}\n  \n\nIn this form it is clear that the purpose of Z is to ensure that the resulting distribution over Yi is in fact a probability distribution, i.e. it sums to 1.  This means that Z is simply the sum of all un-normalized probabilities, and by dividing each probability by Z, the probabilities become \"normalized\".  That is:\n\n  \n    \n      \n        Z\n        =\n        \n          e\n          \n            \n              \n                β\n              \n              \n                0\n              \n            \n            ⋅\n            \n              \n                X\n              \n              \n                i\n              \n            \n          \n        \n        +\n        \n          e\n          \n            \n              \n                β\n              \n              \n                1\n              \n            \n            ⋅\n            \n              \n                X\n              \n              \n                i\n              \n            \n          \n        \n      \n    \n    {\\displaystyle Z=e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}\n  \n\nand the resulting equations are\n\n  \n    \n      \n        \n          \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                0\n                )\n              \n              \n                \n                =\n                \n                  \n                    \n                      e\n                      \n                        \n                          \n                            β\n                          \n                          \n                            0\n                          \n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                  \n                \n              \n            \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                )\n              \n              \n                \n                =\n                \n                  \n                    \n                      e\n                      \n                        \n                          \n                            β\n                          \n                          \n                            1\n                          \n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\Pr(Y_{i}=0)&={\\frac {e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}}{e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}}\\\\[5pt]\\Pr(Y_{i}=1)&={\\frac {e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}{e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}}.\\end{aligned}}}\n  \n\nOr generally:\n\n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        c\n        )\n        =\n        \n          \n            \n              e\n              \n                \n                  \n                    β\n                  \n                  \n                    c\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n              \n            \n            \n              \n                ∑\n                \n                  h\n                \n              \n              \n                e\n                \n                  \n                    \n                      β\n                    \n                    \n                      h\n                    \n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\Pr(Y_{i}=c)={\\frac {e^{{\\boldsymbol {\\beta }}_{c}\\cdot \\mathbf {X} _{i}}}{\\sum _{h}e^{{\\boldsymbol {\\beta }}_{h}\\cdot \\mathbf {X} _{i}}}}}\n  \n\nThis shows clearly how to generalize this formulation to more than two outcomes, as in multinomial logit.\nThis general formulation is exactly the softmax function as in\n\n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        c\n        )\n        =\n        softmax\n        ⁡\n        (\n        c\n        ,\n        \n          \n            β\n          \n          \n            0\n          \n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        ,\n        \n          \n            β\n          \n          \n            1\n          \n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        ,\n        …\n        )\n        .\n      \n    \n    {\\displaystyle \\Pr(Y_{i}=c)=\\operatorname {softmax} (c,{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i},{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i},\\dots ).}\n  \n\nTo prove that this is equivalent to the previous model, we start by recognizing the above model is overspecified, in that \n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        0\n        )\n      \n    \n    {\\displaystyle \\Pr(Y_{i}=0)}\n  \n and \n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        1\n        )\n      \n    \n    {\\displaystyle \\Pr(Y_{i}=1)}\n  \n cannot be independently specified: rather \n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        0\n        )\n        +\n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        1\n        )\n        =\n        1\n      \n    \n    {\\displaystyle \\Pr(Y_{i}=0)+\\Pr(Y_{i}=1)=1}\n  \n so knowing one automatically determines the other.  As a result, the model is nonidentifiable, in that multiple combinations of \n  \n    \n      \n        \n          \n            β\n          \n          \n            0\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}_{0}}\n  \n and \n  \n    \n      \n        \n          \n            β\n          \n          \n            1\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}_{1}}\n  \n will produce the same probabilities for all possible explanatory variables.  In fact, it can be seen that adding any constant vector to both of them will produce the same probabilities:\n\n  \n    \n      \n        \n          \n            \n              \n                Pr\n                (\n                \n                  Y\n                  \n                    i\n                  \n                \n                =\n                1\n                )\n              \n              \n                \n                =\n                \n                  \n                    \n                      e\n                      \n                        (\n                        \n                          \n                            β\n                          \n                          \n                            1\n                          \n                        \n                        +\n                        \n                          C\n                        \n                        )\n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          (\n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          +\n                          \n                            C\n                          \n                          )\n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          (\n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          +\n                          \n                            C\n                          \n                          )\n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      \n                        e\n                        \n                          \n                            C\n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      \n                        e\n                        \n                          \n                            C\n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      \n                        e\n                        \n                          \n                            C\n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      \n                        e\n                        \n                          \n                            C\n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          \n                            C\n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      (\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      )\n                    \n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                \n                  \n                    \n                      e\n                      \n                        \n                          \n                            β\n                          \n                          \n                            1\n                          \n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                    \n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              0\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                      +\n                      \n                        e\n                        \n                          \n                            \n                              β\n                            \n                            \n                              1\n                            \n                          \n                          ⋅\n                          \n                            \n                              X\n                            \n                            \n                              i\n                            \n                          \n                        \n                      \n                    \n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}\\Pr(Y_{i}=1)&={\\frac {e^{({\\boldsymbol {\\beta }}_{1}+\\mathbf {C} )\\cdot \\mathbf {X} _{i}}}{e^{({\\boldsymbol {\\beta }}_{0}+\\mathbf {C} )\\cdot \\mathbf {X} _{i}}+e^{({\\boldsymbol {\\beta }}_{1}+\\mathbf {C} )\\cdot \\mathbf {X} _{i}}}}\\\\[5pt]&={\\frac {e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}e^{\\mathbf {C} \\cdot \\mathbf {X} _{i}}}{e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}e^{\\mathbf {C} \\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}e^{\\mathbf {C} \\cdot \\mathbf {X} _{i}}}}\\\\[5pt]&={\\frac {e^{\\mathbf {C} \\cdot \\mathbf {X} _{i}}e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}{e^{\\mathbf {C} \\cdot \\mathbf {X} _{i}}(e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}})}}\\\\[5pt]&={\\frac {e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}{e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}}.\\end{aligned}}}\n  \n\nAs a result, we can simplify matters, and restore identifiability, by picking an arbitrary value for one of the two vectors.  We choose to set \n  \n    \n      \n        \n          \n            β\n          \n          \n            0\n          \n        \n        =\n        \n          0\n        \n        .\n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}_{0}=\\mathbf {0} .}\n  \n  Then,\n\n  \n    \n      \n        \n          e\n          \n            \n              \n                β\n              \n              \n                0\n              \n            \n            ⋅\n            \n              \n                X\n              \n              \n                i\n              \n            \n          \n        \n        =\n        \n          e\n          \n            \n              0\n            \n            ⋅\n            \n              \n                X\n              \n              \n                i\n              \n            \n          \n        \n        =\n        1\n      \n    \n    {\\displaystyle e^{{\\boldsymbol {\\beta }}_{0}\\cdot \\mathbf {X} _{i}}=e^{\\mathbf {0} \\cdot \\mathbf {X} _{i}}=1}\n  \n\nand so\n\n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        1\n        )\n        =\n        \n          \n            \n              e\n              \n                \n                  \n                    β\n                  \n                  \n                    1\n                  \n                \n                ⋅\n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n              \n            \n            \n              1\n              +\n              \n                e\n                \n                  \n                    \n                      β\n                    \n                    \n                      1\n                    \n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                \n              \n            \n          \n        \n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  \n                    \n                      β\n                    \n                    \n                      1\n                    \n                  \n                  ⋅\n                  \n                    \n                      X\n                    \n                    \n                      i\n                    \n                  \n                \n              \n            \n          \n        \n        =\n        \n          p\n          \n            i\n          \n        \n      \n    \n    {\\displaystyle \\Pr(Y_{i}=1)={\\frac {e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}{1+e^{{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}}={\\frac {1}{1+e^{-{\\boldsymbol {\\beta }}_{1}\\cdot \\mathbf {X} _{i}}}}=p_{i}}\n  \n\nwhich shows that this formulation is indeed equivalent to the previous formulation. (As in the two-way latent variable formulation, any settings where \n  \n    \n      \n        \n          β\n        \n        =\n        \n          \n            β\n          \n          \n            1\n          \n        \n        −\n        \n          \n            β\n          \n          \n            0\n          \n        \n      \n    \n    {\\displaystyle {\\boldsymbol {\\beta }}={\\boldsymbol {\\beta }}_{1}-{\\boldsymbol {\\beta }}_{0}}\n  \n will produce equivalent results.)\nMost treatments of the multinomial logit model start out either by extending the \"log-linear\" formulation presented here or the two-way latent variable formulation presented above, since both clearly show the way that the model could be extended to multi-way outcomes.  In general, the presentation with latent variables is more common in econometrics and political science, where discrete choice models and utility theory reign, while the \"log-linear\" formulation here is more common in computer science, e.g. machine learning and natural language processing.\n\n\n=== As a single-layer perceptron ===\nThe model has an equivalent formulation\n\n  \n    \n      \n        \n          p\n          \n            i\n          \n        \n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  (\n                  \n                    β\n                    \n                      0\n                    \n                  \n                  +\n                  \n                    β\n                    \n                      1\n                    \n                  \n                  \n                    x\n                    \n                      1\n                      ,\n                      i\n                    \n                  \n                  +\n                  ⋯\n                  +\n                  \n                    β\n                    \n                      k\n                    \n                  \n                  \n                    x\n                    \n                      k\n                      ,\n                      i\n                    \n                  \n                  )\n                \n              \n            \n          \n        \n        .\n        \n      \n    \n    {\\displaystyle p_{i}={\\frac {1}{1+e^{-(\\beta _{0}+\\beta _{1}x_{1,i}+\\cdots +\\beta _{k}x_{k,i})}}}.\\,}\n  \n\nThis functional form is commonly called a single-layer perceptron or single-layer artificial neural network. A single-layer neural network computes a continuous output instead of a step function. The derivative of pi with respect to  X = (x1, ..., xk) is computed from the general form:\n\n  \n    \n      \n        y\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  f\n                  (\n                  X\n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle y={\\frac {1}{1+e^{-f(X)}}}}\n  \n\nwhere f(X) is an analytic function in X. With this choice, the single-layer neural network is identical to the logistic regression model. This function has a continuous derivative, which allows it to be used in backpropagation. This function is also preferred because its derivative is easily calculated:\n\n  \n    \n      \n        \n          \n            \n              \n                d\n              \n              y\n            \n            \n              \n                d\n              \n              X\n            \n          \n        \n        =\n        y\n        (\n        1\n        −\n        y\n        )\n        \n          \n            \n              \n                d\n              \n              f\n            \n            \n              \n                d\n              \n              X\n            \n          \n        \n        .\n        \n      \n    \n    {\\displaystyle {\\frac {\\mathrm {d} y}{\\mathrm {d} X}}=y(1-y){\\frac {\\mathrm {d} f}{\\mathrm {d} X}}.\\,}\n  \n\n\n=== In terms of binomial data ===\nA closely related model assumes that each i is associated not with a single Bernoulli trial but with ni independent identically distributed trials, where the observation Yi is the number of successes observed (the sum of the individual Bernoulli-distributed random variables), and hence follows a binomial distribution:\n\n  \n    \n      \n        \n          Y\n          \n            i\n          \n        \n        \n        ∼\n        Bin\n        ⁡\n        (\n        \n          n\n          \n            i\n          \n        \n        ,\n        \n          p\n          \n            i\n          \n        \n        )\n        ,\n        \n           for \n        \n        i\n        =\n        1\n        ,\n        …\n        ,\n        n\n      \n    \n    {\\displaystyle Y_{i}\\,\\sim \\operatorname {Bin} (n_{i},p_{i}),{\\text{ for }}i=1,\\dots ,n}\n  \n\nAn example of this distribution is the fraction of seeds (pi) that germinate after ni are planted.\nIn terms of expected values, this model is expressed as follows:\n\n  \n    \n      \n        \n          p\n          \n            i\n          \n        \n        =\n        \n          \n            E\n          \n        \n        ⁡\n        \n          [\n          \n            \n              \n              \n                \n                  \n                    \n                      Y\n                      \n                        i\n                      \n                    \n                    \n                      n\n                      \n                        i\n                      \n                    \n                  \n                \n                \n              \n              |\n            \n            \n            \n              \n                X\n              \n              \n                i\n              \n            \n          \n          ]\n        \n        \n        ,\n      \n    \n    {\\displaystyle p_{i}=\\operatorname {\\mathbb {E} } \\left[\\left.{\\frac {Y_{i}}{n_{i}}}\\,\\right|\\,\\mathbf {X} _{i}\\right]\\,,}\n  \n\nso that\n\n  \n    \n      \n        logit\n        ⁡\n        \n          (\n          \n            \n              \n                E\n              \n            \n            ⁡\n            \n              [\n              \n                \n                  \n                  \n                    \n                      \n                        \n                          Y\n                          \n                            i\n                          \n                        \n                        \n                          n\n                          \n                            i\n                          \n                        \n                      \n                    \n                    \n                  \n                  |\n                \n                \n                \n                  \n                    X\n                  \n                  \n                    i\n                  \n                \n              \n              ]\n            \n          \n          )\n        \n        =\n        logit\n        ⁡\n        (\n        \n          p\n          \n            i\n          \n        \n        )\n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                p\n                \n                  i\n                \n              \n              \n                1\n                −\n                \n                  p\n                  \n                    i\n                  \n                \n              \n            \n          \n          )\n        \n        =\n        \n          β\n        \n        ⋅\n        \n          \n            X\n          \n          \n            i\n          \n        \n        \n        ,\n      \n    \n    {\\displaystyle \\operatorname {logit} \\left(\\operatorname {\\mathbb {E} } \\left[\\left.{\\frac {Y_{i}}{n_{i}}}\\,\\right|\\,\\mathbf {X} _{i}\\right]\\right)=\\operatorname {logit} (p_{i})=\\ln \\left({\\frac {p_{i}}{1-p_{i}}}\\right)={\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}\\,,}\n  \n\nOr equivalently:\n\n  \n    \n      \n        Pr\n        (\n        \n          Y\n          \n            i\n          \n        \n        =\n        y\n        ∣\n        \n          \n            X\n          \n          \n            i\n          \n        \n        )\n        =\n        \n          \n            \n              (\n            \n            \n              \n                n\n                \n                  i\n                \n              \n              y\n            \n            \n              )\n            \n          \n        \n        \n          p\n          \n            i\n          \n          \n            y\n          \n        \n        (\n        1\n        −\n        \n          p\n          \n            i\n          \n        \n        \n          )\n          \n            \n              n\n              \n                i\n              \n            \n            −\n            y\n          \n        \n        =\n        \n          \n            \n              (\n            \n            \n              \n                n\n                \n                  i\n                \n              \n              y\n            \n            \n              )\n            \n          \n        \n        \n          \n            (\n            \n              \n                1\n                \n                  1\n                  +\n                  \n                    e\n                    \n                      −\n                      \n                        β\n                      \n                      ⋅\n                      \n                        \n                          X\n                        \n                        \n                          i\n                        \n                      \n                    \n                  \n                \n              \n            \n            )\n          \n          \n            y\n          \n        \n        \n          \n            (\n            \n              1\n              −\n              \n                \n                  1\n                  \n                    1\n                    +\n                    \n                      e\n                      \n                        −\n                        \n                          β\n                        \n                        ⋅\n                        \n                          \n                            X\n                          \n                          \n                            i\n                          \n                        \n                      \n                    \n                  \n                \n              \n            \n            )\n          \n          \n            \n              n\n              \n                i\n              \n            \n            −\n            y\n          \n        \n        \n        .\n      \n    \n    {\\displaystyle \\Pr(Y_{i}=y\\mid \\mathbf {X} _{i})={n_{i} \\choose y}p_{i}^{y}(1-p_{i})^{n_{i}-y}={n_{i} \\choose y}\\left({\\frac {1}{1+e^{-{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}\\right)^{y}\\left(1-{\\frac {1}{1+e^{-{\\boldsymbol {\\beta }}\\cdot \\mathbf {X} _{i}}}}\\right)^{n_{i}-y}\\,.}\n  \n\nThis model can be fit using the same sorts of methods as the above more basic model.\n\n\n== Model fitting ==\n\n\n=== Maximum likelihood estimation (MLE) ===\nThe regression coefficients are usually estimated using maximum likelihood estimation. Unlike linear regression with normally distributed residuals, it is not possible to find a closed-form expression for the coefficient values that maximize the likelihood function so an iterative process must be used instead; for example Newton's method. This process begins with a tentative solution, revises it slightly to see if it can be improved, and repeats this revision until no more improvement is made, at which point the process is said to have converged.\nIn some instances, the model may not reach convergence. Non-convergence of a model indicates that the coefficients are not meaningful because the iterative process was unable to find appropriate solutions. A failure to converge may occur for a number of reasons: having a large ratio of predictors to cases, multicollinearity, sparseness, or complete separation.\n\nHaving a large ratio of variables to cases results in an overly conservative Wald statistic (discussed below) and can lead to non-convergence. Regularized logistic regression is specifically intended to be used in this situation.\nMulticollinearity refers to unacceptably high correlations between predictors. As multicollinearity increases, coefficients remain unbiased but standard errors increase and the likelihood of model convergence decreases. To detect multicollinearity amongst the predictors, one can conduct a linear regression analysis with the predictors of interest for the sole purpose of examining the tolerance statistic   used to assess whether multicollinearity is unacceptably high.\nSparseness in the data refers to having a large proportion of empty cells (cells with zero counts). Zero cell counts are particularly problematic with categorical predictors. With continuous predictors, the model can infer values for the zero cell counts, but this is not the case with categorical predictors. The model will not converge with zero cell counts for categorical predictors because the natural logarithm of zero is an undefined value so that the final solution to the model cannot be reached. To remedy this problem, researchers may collapse categories in a theoretically meaningful way or add a constant to all cells.\nAnother numerical problem that may lead to a lack of convergence is complete separation, which refers to the instance in which the predictors perfectly predict the criterion – all cases are accurately classified and the likelihood maximized with infinite coefficients. In such instances, one should re-examine the data, as there may be some kind of error.\nOne can also take semi-parametric or non-parametric approaches, e.g., via local-likelihood or nonparametric quasi-likelihood methods, which avoid assumptions of a parametric form for the index function and is robust to the choice of the link function (e.g., probit or logit).\n\n\n=== Iteratively reweighted least squares (IRLS) ===\nBinary logistic regression (\n  \n    \n      \n        y\n        =\n        0\n      \n    \n    {\\displaystyle y=0}\n  \n or \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n) can, for example, be calculated using iteratively reweighted least squares (IRLS), which is equivalent to maximizing the log-likelihood of a Bernoulli distributed  process using Newton's method. If the problem is written in vector matrix form, with parameters \n  \n    \n      \n        \n          \n            w\n          \n          \n            T\n          \n        \n        =\n        [\n        \n          β\n          \n            0\n          \n        \n        ,\n        \n          β\n          \n            1\n          \n        \n        ,\n        \n          β\n          \n            2\n          \n        \n        ,\n        …\n        ]\n      \n    \n    {\\displaystyle \\mathbf {w} ^{T}=[\\beta _{0},\\beta _{1},\\beta _{2},\\ldots ]}\n  \n, explanatory variables \n  \n    \n      \n        \n          x\n        \n        (\n        i\n        )\n        =\n        [\n        1\n        ,\n        \n          x\n          \n            1\n          \n        \n        (\n        i\n        )\n        ,\n        \n          x\n          \n            2\n          \n        \n        (\n        i\n        )\n        ,\n        …\n        \n          ]\n          \n            T\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {x} (i)=[1,x_{1}(i),x_{2}(i),\\ldots ]^{T}}\n  \n and expected value of the Bernoulli distribution \n  \n    \n      \n        μ\n        (\n        i\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  \n                    \n                      w\n                    \n                    \n                      T\n                    \n                  \n                  \n                    x\n                  \n                  (\n                  i\n                  )\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle \\mu (i)={\\frac {1}{1+e^{-\\mathbf {w} ^{T}\\mathbf {x} (i)}}}}\n  \n, the parameters \n  \n    \n      \n        \n          w\n        \n      \n    \n    {\\displaystyle \\mathbf {w} }\n  \n can be found using the following iterative algorithm:\n\n  \n    \n      \n        \n          \n            w\n          \n          \n            k\n            +\n            1\n          \n        \n        =\n        \n          \n            (\n            \n              \n                \n                  X\n                \n                \n                  T\n                \n              \n              \n                \n                  S\n                \n                \n                  k\n                \n              \n              \n                X\n              \n            \n            )\n          \n          \n            −\n            1\n          \n        \n        \n          \n            X\n          \n          \n            T\n          \n        \n        \n          (\n          \n            \n              \n                S\n              \n              \n                k\n              \n            \n            \n              X\n            \n            \n              \n                w\n              \n              \n                k\n              \n            \n            +\n            \n              y\n            \n            −\n            \n              \n                μ\n              \n              \n                k\n              \n            \n          \n          )\n        \n      \n    \n    {\\displaystyle \\mathbf {w} _{k+1}=\\left(\\mathbf {X} ^{T}\\mathbf {S} _{k}\\mathbf {X} \\right)^{-1}\\mathbf {X} ^{T}\\left(\\mathbf {S} _{k}\\mathbf {X} \\mathbf {w} _{k}+\\mathbf {y} -\\mathbf {\\boldsymbol {\\mu }} _{k}\\right)}\n  \n\nwhere \n  \n    \n      \n        \n          S\n        \n        =\n        diag\n        ⁡\n        (\n        μ\n        (\n        i\n        )\n        (\n        1\n        −\n        μ\n        (\n        i\n        )\n        )\n        )\n      \n    \n    {\\displaystyle \\mathbf {S} =\\operatorname {diag} (\\mu (i)(1-\\mu (i)))}\n  \n is a diagonal weighting matrix, \n  \n    \n      \n        \n          μ\n        \n        =\n        [\n        μ\n        (\n        1\n        )\n        ,\n        μ\n        (\n        2\n        )\n        ,\n        …\n        ]\n      \n    \n    {\\displaystyle {\\boldsymbol {\\mu }}=[\\mu (1),\\mu (2),\\ldots ]}\n  \n the vector of expected values,\n\n  \n    \n      \n        \n          X\n        \n        =\n        \n          \n            [\n            \n              \n                \n                  1\n                \n                \n                  \n                    x\n                    \n                      1\n                    \n                  \n                  (\n                  1\n                  )\n                \n                \n                  \n                    x\n                    \n                      2\n                    \n                  \n                  (\n                  1\n                  )\n                \n                \n                  …\n                \n              \n              \n                \n                  1\n                \n                \n                  \n                    x\n                    \n                      1\n                    \n                  \n                  (\n                  2\n                  )\n                \n                \n                  \n                    x\n                    \n                      2\n                    \n                  \n                  (\n                  2\n                  )\n                \n                \n                  …\n                \n              \n              \n                \n                  ⋮\n                \n                \n                  ⋮\n                \n                \n                  ⋮\n                \n              \n            \n            ]\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {X} ={\\begin{bmatrix}1&x_{1}(1)&x_{2}(1)&\\ldots \\\\1&x_{1}(2)&x_{2}(2)&\\ldots \\\\\\vdots &\\vdots &\\vdots \\end{bmatrix}}}\n  \n\nThe regressor matrix and \n  \n    \n      \n        \n          y\n        \n        (\n        i\n        )\n        =\n        [\n        y\n        (\n        1\n        )\n        ,\n        y\n        (\n        2\n        )\n        ,\n        …\n        \n          ]\n          \n            T\n          \n        \n      \n    \n    {\\displaystyle \\mathbf {y} (i)=[y(1),y(2),\\ldots ]^{T}}\n  \n the vector of response variables. More details can be found in the literature.\n\n\n=== Bayesian ===\n\nIn a Bayesian statistics context, prior distributions are normally placed on the regression coefficients, for example in the form of Gaussian distributions.  There is no conjugate prior of the likelihood function in logistic regression.  When Bayesian inference was performed analytically, this made the posterior distribution difficult to calculate except in very low dimensions.  Now, though, automatic software such as OpenBUGS, JAGS, PyMC, Stan or Turing.jl allows these posteriors to be computed using simulation, so lack of conjugacy is not a concern.  However, when the sample size or the number of parameters is large, full Bayesian simulation can be slow, and people often use approximate methods such as variational Bayesian methods and expectation propagation.\n\n\n=== \"Rule of ten\" ===\n\nWidely used, the \"one in ten rule\", states that logistic regression models give stable values for the explanatory variables if based on a minimum of about 10 events per explanatory variable (EPV); where event denotes the cases belonging to the less frequent category in the dependent variable. Thus a study designed to use \n  \n    \n      \n        k\n      \n    \n    {\\displaystyle k}\n  \n explanatory variables for an event (e.g. myocardial infarction) expected to occur in a proportion \n  \n    \n      \n        p\n      \n    \n    {\\displaystyle p}\n  \n of participants in the study will require a total of \n  \n    \n      \n        10\n        k\n        \n          /\n        \n        p\n      \n    \n    {\\displaystyle 10k/p}\n  \n participants. However, there is considerable debate about the reliability of this rule, which is based on simulation studies and lacks a secure theoretical underpinning. According to some authors the rule is overly conservative in some circumstances, with the authors stating, \"If we (somewhat subjectively) regard confidence interval coverage less than 93 percent, type I error greater than 7 percent, or relative bias greater than 15 percent as problematic, our results indicate that problems are fairly frequent with 2–4 EPV, uncommon with 5–9 EPV, and still observed with 10–16 EPV. The worst instances of each problem were not severe with 5–9 EPV and usually comparable to those with 10–16 EPV\".\nOthers have found results that are not consistent with the above, using different criteria.  A useful criterion is whether the fitted model will be expected to achieve the same predictive discrimination in a new sample as it appeared to achieve in the model development sample.  For that criterion, 20 events per candidate variable may be required.  Also, one can argue that 96 observations are needed only to estimate the model's intercept precisely enough that the margin of error in predicted probabilities is ±0.1 with a 0.95 confidence level.\n\n\n== Error and significance of fit ==\n\n\n=== Deviance and likelihood ratio test ─ a simple case ===\nIn any fitting procedure, the addition of another fitting parameter to a model (e.g. the beta parameters in a logistic regression model) will almost always improve the ability of the model to predict the measured outcomes. This will be true even if the additional term has no predictive value, since the model will simply be \"overfitting\" to the noise in the data.  The question arises as to whether the improvement gained by the addition of another fitting parameter is significant enough to recommend the inclusion of the additional term, or whether the improvement is simply that which may be expected from overfitting.\nIn short, for logistic regression, a statistic known as the deviance is defined which is a measure of the error between the logistic model fit and the outcome data. In the limit of a large number of data points, the deviance is chi-squared distributed, which allows a chi-squared test to be implemented in order to determine the significance of the explanatory variables.\nLinear regression and logistic regression have many similarities. For example, in simple linear regression, a set of K data points (xk, yk) are fitted to a proposed model function of the form \n  \n    \n      \n        y\n        =\n        \n          b\n          \n            0\n          \n        \n        +\n        \n          b\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle y=b_{0}+b_{1}x}\n  \n. The fit is obtained by choosing the b parameters which minimize the sum of the squares of the residuals (the squared error term) for each data point:\n\n  \n    \n      \n        \n          ε\n          \n            2\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        \n          b\n          \n            0\n          \n        \n        +\n        \n          b\n          \n            1\n          \n        \n        \n          x\n          \n            k\n          \n        \n        −\n        \n          y\n          \n            k\n          \n        \n        \n          )\n          \n            2\n          \n        \n        .\n      \n    \n    {\\displaystyle \\varepsilon ^{2}=\\sum _{k=1}^{K}(b_{0}+b_{1}x_{k}-y_{k})^{2}.}\n  \n\nThe minimum value which constitutes the fit will be denoted by \n  \n    \n      \n        \n          \n            \n              \n                ε\n                ^\n              \n            \n          \n          \n            2\n          \n        \n      \n    \n    {\\displaystyle {\\hat {\\varepsilon }}^{2}}\n  \n\nThe idea of a null model may be introduced, in which it is assumed that the x variable is of no use in predicting the yk outcomes: The data points are fitted to a null model function of the form y = b0 with a squared error term:\n\n  \n    \n      \n        \n          ε\n          \n            2\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        \n          b\n          \n            0\n          \n        \n        −\n        \n          y\n          \n            k\n          \n        \n        \n          )\n          \n            2\n          \n        \n        .\n      \n    \n    {\\displaystyle \\varepsilon ^{2}=\\sum _{k=1}^{K}(b_{0}-y_{k})^{2}.}\n  \n\nThe fitting process consists of choosing a value of b0 which minimizes \n  \n    \n      \n        \n          ε\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\varepsilon ^{2}}\n  \n of the fit to the null model, denoted by  \n  \n    \n      \n        \n          ε\n          \n            φ\n          \n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\varepsilon _{\\varphi }^{2}}\n  \n where the \n  \n    \n      \n        φ\n      \n    \n    {\\displaystyle \\varphi }\n  \n subscript denotes the null model. It is seen that the null model is optimized by \n  \n    \n      \n        \n          b\n          \n            0\n          \n        \n        =\n        \n          \n            y\n            ¯\n          \n        \n      \n    \n    {\\displaystyle b_{0}={\\overline {y}}}\n  \n where \n  \n    \n      \n        \n          \n            y\n            ¯\n          \n        \n      \n    \n    {\\displaystyle {\\overline {y}}}\n  \n is the mean of the yk values, and the optimized \n  \n    \n      \n        \n          ε\n          \n            φ\n          \n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\varepsilon _{\\varphi }^{2}}\n  \n is:\n\n  \n    \n      \n        \n          \n            \n              \n                ε\n                ^\n              \n            \n          \n          \n            φ\n          \n          \n            2\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        (\n        \n          \n            y\n            ¯\n          \n        \n        −\n        \n          y\n          \n            k\n          \n        \n        \n          )\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle {\\hat {\\varepsilon }}_{\\varphi }^{2}=\\sum _{k=1}^{K}({\\overline {y}}-y_{k})^{2}}\n  \n\nwhich is proportional to the square of the (uncorrected) sample standard deviation of the yk data points.\nWe can imagine a case where the yk data points are randomly assigned to the various xk, and then fitted using the proposed model. Specifically, we can consider the fits of the proposed model to every permutation of the yk outcomes. It can be shown that the optimized error of any of these fits will never be less than the optimum error of the null model, and that the difference between these minimum error will follow a chi-squared distribution, with degrees of freedom equal those of the proposed model minus those of the null model which, in this case, will be \n  \n    \n      \n        2\n        −\n        1\n        =\n        1\n      \n    \n    {\\displaystyle 2-1=1}\n  \n. Using the chi-squared test, we may then estimate how many of these permuted sets of yk will yield a minimum error less than or equal to the minimum  error using the original yk, and so we can estimate how significant an improvement is given by the inclusion of the x variable in the proposed model.\nFor logistic regression, the measure of goodness-of-fit is the likelihood function L, or its logarithm, the log-likelihood ℓ. The likelihood function L is analogous to the \n  \n    \n      \n        \n          ε\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\varepsilon ^{2}}\n  \n in the linear regression case, except that the likelihood is maximized rather than minimized. Denote the maximized log-likelihood of the proposed model by \n  \n    \n      \n        \n          \n            \n              ℓ\n              ^\n            \n          \n        \n      \n    \n    {\\displaystyle {\\hat {\\ell }}}\n  \n.\nIn the case of simple binary logistic regression, the set of K data points are fitted in a probabilistic sense to a function of the form:\n\n  \n    \n      \n        p\n        (\n        x\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  t\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p(x)={\\frac {1}{1+e^{-t}}}}\n  \n\nwhere ⁠\n  \n    \n      \n        p\n        (\n        x\n        )\n      \n    \n    {\\displaystyle p(x)}\n  \n⁠ is the probability that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n. The log-odds are given by:\n\n  \n    \n      \n        t\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle t=\\beta _{0}+\\beta _{1}x}\n  \n\nand the log-likelihood is:\n\n  \n    \n      \n        ℓ\n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          (\n          \n            \n              y\n              \n                k\n              \n            \n            ln\n            ⁡\n            (\n            p\n            (\n            \n              x\n              \n                k\n              \n            \n            )\n            )\n            +\n            (\n            1\n            −\n            \n              y\n              \n                k\n              \n            \n            )\n            ln\n            ⁡\n            (\n            1\n            −\n            p\n            (\n            \n              x\n              \n                k\n              \n            \n            )\n            )\n          \n          )\n        \n      \n    \n    {\\displaystyle \\ell =\\sum _{k=1}^{K}\\left(y_{k}\\ln(p(x_{k}))+(1-y_{k})\\ln(1-p(x_{k}))\\right)}\n  \n\nFor the null model, the probability that \n  \n    \n      \n        y\n        =\n        1\n      \n    \n    {\\displaystyle y=1}\n  \n is given by:\n\n  \n    \n      \n        \n          p\n          \n            φ\n          \n        \n        (\n        x\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  \n                    t\n                    \n                      φ\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle p_{\\varphi }(x)={\\frac {1}{1+e^{-t_{\\varphi }}}}}\n  \n\nThe log-odds for the null model are given by:\n\n  \n    \n      \n        \n          t\n          \n            φ\n          \n        \n        =\n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle t_{\\varphi }=\\beta _{0}}\n  \n\nand the log-likelihood is:\n\n  \n    \n      \n        \n          ℓ\n          \n            φ\n          \n        \n        =\n        \n          ∑\n          \n            k\n            =\n            1\n          \n          \n            K\n          \n        \n        \n          (\n          \n            \n              y\n              \n                k\n              \n            \n            ln\n            ⁡\n            (\n            \n              p\n              \n                φ\n              \n            \n            )\n            +\n            (\n            1\n            −\n            \n              y\n              \n                k\n              \n            \n            )\n            ln\n            ⁡\n            (\n            1\n            −\n            \n              p\n              \n                φ\n              \n            \n            )\n          \n          )\n        \n      \n    \n    {\\displaystyle \\ell _{\\varphi }=\\sum _{k=1}^{K}\\left(y_{k}\\ln(p_{\\varphi })+(1-y_{k})\\ln(1-p_{\\varphi })\\right)}\n  \n\nSince we have \n  \n    \n      \n        \n          p\n          \n            φ\n          \n        \n        =\n        \n          \n            y\n            ¯\n          \n        \n      \n    \n    {\\displaystyle p_{\\varphi }={\\overline {y}}}\n  \n at the maximum of L, the maximum log-likelihood for the null model is\n\n  \n    \n      \n        \n          \n            \n              \n                ℓ\n                ^\n              \n            \n          \n          \n            φ\n          \n        \n        =\n        K\n        (\n        \n        \n          \n            y\n            ¯\n          \n        \n        ln\n        ⁡\n        (\n        \n          \n            y\n            ¯\n          \n        \n        )\n        +\n        (\n        1\n        −\n        \n          \n            y\n            ¯\n          \n        \n        )\n        ln\n        ⁡\n        (\n        1\n        −\n        \n          \n            y\n            ¯\n          \n        \n        )\n        )\n      \n    \n    {\\displaystyle {\\hat {\\ell }}_{\\varphi }=K(\\,{\\overline {y}}\\ln({\\overline {y}})+(1-{\\overline {y}})\\ln(1-{\\overline {y}}))}\n  \n\nThe optimum \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n is:\n\n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                y\n                ¯\n              \n              \n                1\n                −\n                \n                  \n                    y\n                    ¯\n                  \n                \n              \n            \n          \n          )\n        \n      \n    \n    {\\displaystyle \\beta _{0}=\\ln \\left({\\frac {\\overline {y}}{1-{\\overline {y}}}}\\right)}\n  \n\nwhere \n  \n    \n      \n        \n          \n            y\n            ¯\n          \n        \n      \n    \n    {\\displaystyle {\\overline {y}}}\n  \n is again the mean of the yk values. Again, we can conceptually consider the fit of the proposed model to every permutation of the yk and it can be shown that the maximum log-likelihood of these permutation fits will never be smaller than that of the null model:\n\n  \n    \n      \n        \n          \n            \n              ℓ\n              ^\n            \n          \n        \n        ≥\n        \n          \n            \n              \n                ℓ\n                ^\n              \n            \n          \n          \n            φ\n          \n        \n      \n    \n    {\\displaystyle {\\hat {\\ell }}\\geq {\\hat {\\ell }}_{\\varphi }}\n  \n\nAlso, as an analog to the error of the linear regression case, we may define the deviance of a logistic regression fit as:\n\n  \n    \n      \n        D\n        =\n        ln\n        ⁡\n        \n          (\n          \n            \n              \n                \n                  \n                    \n                      L\n                      ^\n                    \n                  \n                \n                \n                  2\n                \n              \n              \n                \n                  \n                    \n                      L\n                      ^\n                    \n                  \n                \n                \n                  φ\n                \n                \n                  2\n                \n              \n            \n          \n          )\n        \n        =\n        2\n        (\n        \n          \n            \n              ℓ\n              ^\n            \n          \n        \n        −\n        \n          \n            \n              \n                ℓ\n                ^\n              \n            \n          \n          \n            φ\n          \n        \n        )\n      \n    \n    {\\displaystyle D=\\ln \\left({\\frac {{\\hat {L}}^{2}}{{\\hat {L}}_{\\varphi }^{2}}}\\right)=2({\\hat {\\ell }}-{\\hat {\\ell }}_{\\varphi })}\n  \n\nwhich will always be positive or zero. The reason for this choice is that not only is the deviance a good measure of the goodness of fit, it is also approximately chi-squared distributed, with the approximation improving as the number of data points (K) increases, becoming exactly chi-square distributed in the limit of an infinite number of data points. As in the case of linear regression, we may use this fact to estimate the probability that a random set of data points will give a better fit than the fit obtained by the proposed model, and so have an estimate how significantly the model is improved by including the xk data points in the proposed model.\nFor the simple model of student test scores described above, the maximum value of the log-likelihood of the null model is \n  \n    \n      \n        \n          \n            \n              \n                ℓ\n                ^\n              \n            \n          \n          \n            φ\n          \n        \n        =\n        −\n        13.8629\n        …\n      \n    \n    {\\displaystyle {\\hat {\\ell }}_{\\varphi }=-13.8629\\ldots }\n  \n The maximum value of the log-likelihood for the simple model is \n  \n    \n      \n        \n          \n            \n              ℓ\n              ^\n            \n          \n        \n        =\n        −\n        8.02988\n        …\n      \n    \n    {\\displaystyle {\\hat {\\ell }}=-8.02988\\ldots }\n  \n so that the deviance is \n  \n    \n      \n        D\n        =\n        2\n        (\n        \n          \n            \n              ℓ\n              ^\n            \n          \n        \n        −\n        \n          \n            \n              \n                ℓ\n                ^\n              \n            \n          \n          \n            φ\n          \n        \n        )\n        =\n        11.6661\n        …\n      \n    \n    {\\displaystyle D=2({\\hat {\\ell }}-{\\hat {\\ell }}_{\\varphi })=11.6661\\ldots }\n  \n\nUsing the chi-squared test of significance, the integral of the chi-squared distribution with one degree of freedom from 11.6661... to infinity is equal to 0.00063649...\nThis effectively means that about 6 out of a 10,000 fits to random yk can be expected to have a better fit (smaller deviance) than the given yk and so we can conclude that the inclusion of the x variable and data in the proposed model is a very significant improvement over the null model. In other words, we reject the null hypothesis with \n  \n    \n      \n        1\n        −\n        D\n        ≈\n        99.94\n        %\n      \n    \n    {\\displaystyle 1-D\\approx 99.94\\%}\n  \n confidence.\n\n\n=== Goodness of fit summary ===\nGoodness of fit in linear regression models is generally measured using R2. Since this has no direct analog in logistic regression, various methods including the following can be used instead.\n\n\n==== Deviance and likelihood ratio tests ====\nIn linear regression analysis, one is concerned with partitioning variance via the sum of squares calculations – variance in the criterion is essentially divided into variance accounted for by the predictors and residual variance. In logistic regression analysis, deviance is used in lieu of a sum of squares calculations. Deviance is analogous to the sum of squares calculations in linear regression  and is a measure of the lack of fit to the data in a logistic regression model. When a \"saturated\" model is available (a model with a theoretically perfect fit), deviance is calculated by comparing a given model with the saturated model.  This computation gives the likelihood-ratio test:\n\n  \n    \n      \n        D\n        =\n        −\n        2\n        ln\n        ⁡\n        \n          \n            likelihood of the fitted model\n            likelihood of the saturated model\n          \n        \n        .\n      \n    \n    {\\displaystyle D=-2\\ln {\\frac {\\text{likelihood of the fitted model}}{\\text{likelihood of the saturated model}}}.}\n  \n\nIn the above equation, D represents the deviance and ln represents the natural logarithm. The log of this likelihood ratio (the ratio of the fitted model to the saturated model) will produce a negative value, hence the need for a negative sign. D can be shown to follow an approximate chi-squared distribution.  Smaller values indicate better fit as the fitted model deviates less from the saturated model. When assessed upon a chi-square distribution, nonsignificant chi-square values indicate very little unexplained variance and thus, good model fit. Conversely, a significant chi-square value indicates that a significant amount of the variance is unexplained.\nWhen the saturated model is not available (a common case), deviance is calculated simply as −2·(log likelihood of the fitted model), and the reference to the saturated model's log likelihood can be removed from all that follows without harm.\nTwo measures of deviance are particularly important in logistic regression: null deviance and model deviance. The null deviance represents the difference between a model with only the intercept (which means \"no predictors\") and the saturated model. The model deviance represents the difference between a model with at least one predictor and the saturated model. In this respect, the null model provides a baseline upon which to compare predictor models. Given that deviance is a measure of the difference between a given model and the saturated model, smaller values indicate better fit. Thus, to assess the contribution of a predictor or set of predictors, one can subtract the model deviance from the null deviance and assess the difference on a \n  \n    \n      \n        \n          χ\n          \n            s\n            −\n            p\n          \n          \n            2\n          \n        \n        ,\n      \n    \n    {\\displaystyle \\chi _{s-p}^{2},}\n  \n  chi-square distribution with degrees of freedom equal to the difference in the number of parameters estimated.\nLet\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  D\n                  \n                    null\n                  \n                \n              \n              \n                \n                =\n                −\n                2\n                ln\n                ⁡\n                \n                  \n                    likelihood of null model\n                    likelihood of the saturated model\n                  \n                \n              \n            \n            \n              \n                \n                  D\n                  \n                    fitted\n                  \n                \n              \n              \n                \n                =\n                −\n                2\n                ln\n                ⁡\n                \n                  \n                    likelihood of fitted model\n                    likelihood of the saturated model\n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}D_{\\text{null}}&=-2\\ln {\\frac {\\text{likelihood of null model}}{\\text{likelihood of the saturated model}}}\\\\[6pt]D_{\\text{fitted}}&=-2\\ln {\\frac {\\text{likelihood of fitted model}}{\\text{likelihood of the saturated model}}}.\\end{aligned}}}\n  \n\nThen the difference of both is:\n\n  \n    \n      \n        \n          \n            \n              \n                \n                  D\n                  \n                    null\n                  \n                \n                −\n                \n                  D\n                  \n                    fitted\n                  \n                \n              \n              \n                \n                =\n                −\n                2\n                \n                  (\n                  \n                    ln\n                    ⁡\n                    \n                      \n                        likelihood of null model\n                        likelihood of the saturated model\n                      \n                    \n                    −\n                    ln\n                    ⁡\n                    \n                      \n                        likelihood of fitted model\n                        likelihood of the saturated model\n                      \n                    \n                  \n                  )\n                \n              \n            \n            \n              \n              \n                \n                =\n                −\n                2\n                ln\n                ⁡\n                \n                  \n                    \n                      (\n                      \n                        \n                          \n                            likelihood of null model\n                            likelihood of the saturated model\n                          \n                        \n                      \n                      )\n                    \n                    \n                      (\n                      \n                        \n                          \n                            likelihood of fitted model\n                            likelihood of the saturated model\n                          \n                        \n                      \n                      )\n                    \n                  \n                \n              \n            \n            \n              \n              \n                \n                =\n                −\n                2\n                ln\n                ⁡\n                \n                  \n                    likelihood of the null model\n                    likelihood of fitted model\n                  \n                \n                .\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}D_{\\text{null}}-D_{\\text{fitted}}&=-2\\left(\\ln {\\frac {\\text{likelihood of null model}}{\\text{likelihood of the saturated model}}}-\\ln {\\frac {\\text{likelihood of fitted model}}{\\text{likelihood of the saturated model}}}\\right)\\\\[6pt]&=-2\\ln {\\frac {\\left({\\dfrac {\\text{likelihood of null model}}{\\text{likelihood of the saturated model}}}\\right)}{\\left({\\dfrac {\\text{likelihood of fitted model}}{\\text{likelihood of the saturated model}}}\\right)}}\\\\[6pt]&=-2\\ln {\\frac {\\text{likelihood of the null model}}{\\text{likelihood of fitted model}}}.\\end{aligned}}}\n  \n\nIf the model deviance is significantly smaller than the null deviance then one can conclude that the predictor or set of predictors significantly improve the model's fit. This is analogous to the F-test used in linear regression analysis to assess the significance of prediction.\n\n\n==== Pseudo-R-squared ====\n\nIn linear regression the squared multiple correlation, R2 is used to assess goodness of fit as it represents the proportion of variance in the criterion that is explained by the predictors. In logistic regression analysis, there is no agreed upon analogous measure, but there are several competing measures each with limitations.\nFour of the most commonly used indices and one less commonly used one are examined on this page:\n\nLikelihood ratio R2L\nCox and Snell R2CS\nNagelkerke R2N\nMcFadden R2McF\nTjur R2T\n\n\n==== Hosmer–Lemeshow test ====\nThe Hosmer–Lemeshow test uses a test statistic that asymptotically follows a \n  \n    \n      \n        \n          χ\n          \n            2\n          \n        \n      \n    \n    {\\displaystyle \\chi ^{2}}\n  \n distribution to assess whether or not the observed event rates match expected event rates in subgroups of the model population.  This test is considered to be obsolete by some statisticians because of its dependence on arbitrary binning of predicted probabilities and relative low power.\n\n\n=== Coefficient significance ===\nAfter fitting the model, it is likely that researchers will want to examine the contribution of individual predictors. To do so, they will want to examine the regression coefficients. In linear regression, the regression coefficients represent the change in the criterion for each unit change in the predictor. In logistic regression, however, the regression coefficients represent the change in the logit for each unit change in the predictor. Given that the logit is not intuitive, researchers are likely to focus on a predictor's effect on the exponential function of the regression coefficient – the odds ratio (see definition). In linear regression, the significance of a regression coefficient is assessed by computing a t test. In logistic regression, there are several different tests designed to assess the significance of an individual predictor, most notably the likelihood ratio test and the Wald statistic.\n\n\n==== Likelihood ratio test ====\nThe likelihood-ratio test discussed above to assess model fit is also the recommended procedure to assess the contribution of individual \"predictors\" to a given model. In the case of a single predictor model, one simply compares the deviance of the predictor model with that of the null model on a chi-square distribution with a single degree of freedom. If the predictor model has significantly smaller deviance (c.f. chi-square using the difference in degrees of freedom of the two models), then one can conclude that there is a significant association between the \"predictor\" and the outcome. Although some common statistical packages (e.g. SPSS) do provide likelihood ratio test statistics, without this computationally intensive test it would be more difficult to assess the contribution of individual predictors in the multiple logistic regression case. To assess the contribution of individual predictors one can enter the predictors hierarchically, comparing each new model with the previous to determine the contribution of each predictor. There is some debate among statisticians about the appropriateness of so-called \"stepwise\" procedures. The fear is that they may not preserve nominal statistical properties and may become misleading.\n\n\n==== Wald statistic ====\nAlternatively, when assessing the contribution of individual predictors in a given model, one may examine the significance of the Wald statistic. The Wald statistic, analogous to the t-test in linear regression, is used to assess the significance of coefficients. The Wald statistic is the ratio of the square of the regression coefficient to the square of the standard error of the coefficient and is asymptotically distributed as a chi-square distribution.\n\n  \n    \n      \n        \n          W\n          \n            j\n          \n        \n        =\n        \n          \n            \n              β\n              \n                j\n              \n              \n                2\n              \n            \n            \n              S\n              \n                E\n                \n                  \n                    β\n                    \n                      j\n                    \n                  \n                \n                \n                  2\n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle W_{j}={\\frac {\\beta _{j}^{2}}{SE_{\\beta _{j}}^{2}}}}\n  \n\nAlthough several statistical packages (e.g., SPSS, SAS) report the Wald statistic to assess the contribution of individual predictors, the Wald statistic has limitations. When the regression coefficient is large, the standard error of the regression coefficient also tends to be larger increasing the probability of Type-II error. The Wald statistic also tends to be biased when data are sparse.\n\n\n==== Case-control sampling ====\nSuppose cases are rare. Then we might wish to sample them more frequently than their prevalence in the population. For example, suppose there is a disease that affects 1 person in 10,000 and to collect our data we need to do a complete physical. It may be too expensive to do thousands of physicals of healthy people in order to obtain data for only a few diseased individuals. Thus, we may evaluate more diseased individuals, perhaps all of the rare outcomes. This is also retrospective sampling, or equivalently it is called unbalanced data. As a rule of thumb, sampling controls at a rate of five times the number of cases will produce sufficient control data.\nLogistic regression is unique in that it may be estimated on unbalanced data, rather than randomly sampled data, and still yield correct coefficient estimates of the effects of each independent variable on the outcome.  That is to say, if we form a logistic model from such data, if the model is correct in the general population, the \n  \n    \n      \n        \n          β\n          \n            j\n          \n        \n      \n    \n    {\\displaystyle \\beta _{j}}\n  \n parameters are all correct except for \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n. We can correct \n  \n    \n      \n        \n          β\n          \n            0\n          \n        \n      \n    \n    {\\displaystyle \\beta _{0}}\n  \n if we know the true prevalence as follows:\n\n  \n    \n      \n        \n          \n            \n              \n                β\n                ^\n              \n            \n          \n          \n            0\n          \n          \n            ∗\n          \n        \n        =\n        \n          \n            \n              \n                β\n                ^\n              \n            \n          \n          \n            0\n          \n        \n        +\n        log\n        ⁡\n        \n          \n            π\n            \n              1\n              −\n              π\n            \n          \n        \n        −\n        log\n        ⁡\n        \n          \n            \n              \n                \n                  π\n                  ~\n                \n              \n            \n            \n              1\n              −\n              \n                \n                  \n                    π\n                    ~\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\widehat {\\beta }}_{0}^{*}={\\widehat {\\beta }}_{0}+\\log {\\frac {\\pi }{1-\\pi }}-\\log {{\\tilde {\\pi }} \\over {1-{\\tilde {\\pi }}}}}\n  \n\nwhere \n  \n    \n      \n        π\n      \n    \n    {\\displaystyle \\pi }\n  \n is the true prevalence and \n  \n    \n      \n        \n          \n            \n              π\n              ~\n            \n          \n        \n      \n    \n    {\\displaystyle {\\tilde {\\pi }}}\n  \n is the prevalence in the sample.\n\n\n== Discussion ==\nLike other forms of regression analysis, logistic regression makes use of one or more predictor variables that may be either continuous or categorical. Unlike ordinary linear regression, however, logistic regression is used for predicting dependent variables that take membership in one of a limited number of categories (treating the dependent variable in the binomial case as the outcome of a Bernoulli trial) rather than a continuous outcome. Given this difference, the assumptions of linear regression are violated. In particular, the residuals cannot be normally distributed. In addition, linear regression may make nonsensical predictions for a binary dependent variable. What is needed is a way to convert a binary variable into a continuous one that can take on any real value (negative or positive). To do that, binomial logistic regression first calculates the odds of the event happening for different levels of each independent variable, and then takes its logarithm to create a continuous criterion as a transformed version of the dependent variable. The logarithm of the odds is the logit of the probability, the logit is defined as follows:\n\n  \n    \n      \n        logit\n        ⁡\n        p\n        =\n        ln\n        ⁡\n        \n          \n            p\n            \n              1\n              −\n              p\n            \n          \n        \n        \n        \n          for \n        \n        0\n        <\n        p\n        <\n        1\n        \n        .\n      \n    \n    {\\displaystyle \\operatorname {logit} p=\\ln {\\frac {p}{1-p}}\\quad {\\text{for }}0<p<1\\,.}\n  \n\nAlthough the dependent variable in logistic regression is Bernoulli, the logit is on an unrestricted scale. The logit function is the link function in this kind of generalized linear model, i.e.\n\n  \n    \n      \n        logit\n        ⁡\n        \n          \n            E\n          \n        \n        ⁡\n        (\n        Y\n        )\n        =\n        \n          β\n          \n            0\n          \n        \n        +\n        \n          β\n          \n            1\n          \n        \n        x\n      \n    \n    {\\displaystyle \\operatorname {logit} \\operatorname {\\mathcal {E}} (Y)=\\beta _{0}+\\beta _{1}x}\n  \n\nY is the Bernoulli-distributed response variable and x is the predictor variable; the β values are the linear parameters.\nThe logit of the probability of success is then fitted to the predictors. The predicted value of the logit is converted back into predicted odds, via the inverse of the natural logarithm – the exponential function. Thus, although the observed dependent variable in binary logistic regression is a 0-or-1 variable, the logistic regression estimates the odds, as a continuous variable, that the dependent variable is a 'success'. In some applications, the odds are all that is needed. In others, a specific yes-or-no prediction is needed for whether the dependent variable is or is not a 'success'; this categorical prediction can be based on the computed odds of success, with predicted odds above some chosen cutoff value being translated into a prediction of success.\n\n\n== Machine learning and cross-entropy loss function ==\nIn machine learning applications where logistic regression is used for binary classification, the MLE minimises the cross-entropy loss function.\nLogistic regression is an important machine learning algorithm. The goal is to model the probability of a random variable \n  \n    \n      \n        Y\n      \n    \n    {\\displaystyle Y}\n  \n being 0 or 1 given experimental data.\nConsider a generalized linear model function parameterized by \n  \n    \n      \n        θ\n      \n    \n    {\\displaystyle \\theta }\n  \n,\n\n  \n    \n      \n        \n          h\n          \n            θ\n          \n        \n        (\n        X\n        )\n        =\n        \n          \n            1\n            \n              1\n              +\n              \n                e\n                \n                  −\n                  \n                    θ\n                    \n                      T\n                    \n                  \n                  X\n                \n              \n            \n          \n        \n        =\n        Pr\n        (\n        Y\n        =\n        1\n        ∣\n        X\n        ;\n        θ\n        )\n      \n    \n    {\\displaystyle h_{\\theta }(X)={\\frac {1}{1+e^{-\\theta ^{T}X}}}=\\Pr(Y=1\\mid X;\\theta )}\n  \n\nTherefore,\n\n  \n    \n      \n        Pr\n        (\n        Y\n        =\n        0\n        ∣\n        X\n        ;\n        θ\n        )\n        =\n        1\n        −\n        \n          h\n          \n            θ\n          \n        \n        (\n        X\n        )\n      \n    \n    {\\displaystyle \\Pr(Y=0\\mid X;\\theta )=1-h_{\\theta }(X)}\n  \n\nand since \n  \n    \n      \n        Y\n        ∈\n        {\n        0\n        ,\n        1\n        }\n      \n    \n    {\\displaystyle Y\\in \\{0,1\\}}\n  \n, we see that \n  \n    \n      \n        Pr\n        (\n        y\n        ∣\n        X\n        ;\n        θ\n        )\n      \n    \n    {\\displaystyle \\Pr(y\\mid X;\\theta )}\n  \n is given by \n  \n    \n      \n        Pr\n        (\n        y\n        ∣\n        X\n        ;\n        θ\n        )\n        =\n        \n          h\n          \n            θ\n          \n        \n        (\n        X\n        \n          )\n          \n            y\n          \n        \n        (\n        1\n        −\n        \n          h\n          \n            θ\n          \n        \n        (\n        X\n        )\n        \n          )\n          \n            (\n            1\n            −\n            y\n            )\n          \n        \n        .\n      \n    \n    {\\displaystyle \\Pr(y\\mid X;\\theta )=h_{\\theta }(X)^{y}(1-h_{\\theta }(X))^{(1-y)}.}\n  \n We now calculate the likelihood function assuming that all the observations in the sample are independently Bernoulli distributed,\n\n  \n    \n      \n        \n          \n            \n              \n                L\n                (\n                θ\n                ∣\n                y\n                ;\n                x\n                )\n              \n              \n                \n                =\n                Pr\n                (\n                Y\n                ∣\n                X\n                ;\n                θ\n                )\n              \n            \n            \n              \n              \n                \n                =\n                \n                  ∏\n                  \n                    i\n                  \n                \n                Pr\n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                ∣\n                \n                  x\n                  \n                    i\n                  \n                \n                ;\n                θ\n                )\n              \n            \n            \n              \n              \n                \n                =\n                \n                  ∏\n                  \n                    i\n                  \n                \n                \n                  h\n                  \n                    θ\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                \n                  )\n                  \n                    \n                      y\n                      \n                        i\n                      \n                    \n                  \n                \n                (\n                1\n                −\n                \n                  h\n                  \n                    θ\n                  \n                \n                (\n                \n                  x\n                  \n                    i\n                  \n                \n                )\n                \n                  )\n                  \n                    (\n                    1\n                    −\n                    \n                      y\n                      \n                        i\n                      \n                    \n                    )\n                  \n                \n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}L(\\theta \\mid y;x)&=\\Pr(Y\\mid X;\\theta )\\\\&=\\prod _{i}\\Pr(y_{i}\\mid x_{i};\\theta )\\\\&=\\prod _{i}h_{\\theta }(x_{i})^{y_{i}}(1-h_{\\theta }(x_{i}))^{(1-y_{i})}\\end{aligned}}}\n  \n\nTypically, the log likelihood is maximized,\n\n  \n    \n      \n        \n          N\n          \n            −\n            1\n          \n        \n        log\n        ⁡\n        L\n        (\n        θ\n        ∣\n        y\n        ;\n        x\n        )\n        =\n        \n          N\n          \n            −\n            1\n          \n        \n        \n          ∑\n          \n            i\n            =\n            1\n          \n          \n            N\n          \n        \n        log\n        ⁡\n        Pr\n        (\n        \n          y\n          \n            i\n          \n        \n        ∣\n        \n          x\n          \n            i\n          \n        \n        ;\n        θ\n        )\n      \n    \n    {\\displaystyle N^{-1}\\log L(\\theta \\mid y;x)=N^{-1}\\sum _{i=1}^{N}\\log \\Pr(y_{i}\\mid x_{i};\\theta )}\n  \n\nwhich is maximized using optimization techniques such as gradient descent.\nAssuming the \n  \n    \n      \n        (\n        x\n        ,\n        y\n        )\n      \n    \n    {\\displaystyle (x,y)}\n  \n pairs are drawn uniformly from the underlying distribution, then in the limit of large N,\n\n  \n    \n      \n        \n          \n            \n              \n              \n                \n                \n                  lim\n                  \n                    N\n                    →\n                    +\n                    ∞\n                  \n                \n                \n                  N\n                  \n                    −\n                    1\n                  \n                \n                \n                  ∑\n                  \n                    i\n                    =\n                    1\n                  \n                  \n                    N\n                  \n                \n                log\n                ⁡\n                Pr\n                (\n                \n                  y\n                  \n                    i\n                  \n                \n                ∣\n                \n                  x\n                  \n                    i\n                  \n                \n                ;\n                θ\n                )\n                =\n                \n                  ∑\n                  \n                    x\n                    ∈\n                    \n                      \n                        X\n                      \n                    \n                  \n                \n                \n                  ∑\n                  \n                    y\n                    ∈\n                    \n                      \n                        Y\n                      \n                    \n                  \n                \n                Pr\n                (\n                X\n                =\n                x\n                ,\n                Y\n                =\n                y\n                )\n                log\n                ⁡\n                Pr\n                (\n                Y\n                =\n                y\n                ∣\n                X\n                =\n                x\n                ;\n                θ\n                )\n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                \n                  ∑\n                  \n                    x\n                    ∈\n                    \n                      \n                        X\n                      \n                    \n                  \n                \n                \n                  ∑\n                  \n                    y\n                    ∈\n                    \n                      \n                        Y\n                      \n                    \n                  \n                \n                Pr\n                (\n                X\n                =\n                x\n                ,\n                Y\n                =\n                y\n                )\n                \n                  (\n                  \n                    −\n                    log\n                    ⁡\n                    \n                      \n                        \n                          Pr\n                          (\n                          Y\n                          =\n                          y\n                          ∣\n                          X\n                          =\n                          x\n                          )\n                        \n                        \n                          Pr\n                          (\n                          Y\n                          =\n                          y\n                          ∣\n                          X\n                          =\n                          x\n                          ;\n                          θ\n                          )\n                        \n                      \n                    \n                    +\n                    log\n                    ⁡\n                    Pr\n                    (\n                    Y\n                    =\n                    y\n                    ∣\n                    X\n                    =\n                    x\n                    )\n                  \n                  )\n                \n              \n            \n            \n              \n                =\n                \n\n                \n              \n              \n                \n                −\n                \n                  D\n                  \n                    KL\n                  \n                \n                (\n                Y\n                ∥\n                \n                  Y\n                  \n                    θ\n                  \n                \n                )\n                −\n                H\n                (\n                Y\n                ∣\n                X\n                )\n              \n            \n          \n        \n      \n    \n    {\\displaystyle {\\begin{aligned}&\\lim \\limits _{N\\rightarrow +\\infty }N^{-1}\\sum _{i=1}^{N}\\log \\Pr(y_{i}\\mid x_{i};\\theta )=\\sum _{x\\in {\\mathcal {X}}}\\sum _{y\\in {\\mathcal {Y}}}\\Pr(X=x,Y=y)\\log \\Pr(Y=y\\mid X=x;\\theta )\\\\[6pt]={}&\\sum _{x\\in {\\mathcal {X}}}\\sum _{y\\in {\\mathcal {Y}}}\\Pr(X=x,Y=y)\\left(-\\log {\\frac {\\Pr(Y=y\\mid X=x)}{\\Pr(Y=y\\mid X=x;\\theta )}}+\\log \\Pr(Y=y\\mid X=x)\\right)\\\\[6pt]={}&-D_{\\text{KL}}(Y\\parallel Y_{\\theta })-H(Y\\mid X)\\end{aligned}}}\n  \n\nwhere \n  \n    \n      \n        H\n        (\n        Y\n        ∣\n        X\n        )\n      \n    \n    {\\displaystyle H(Y\\mid X)}\n  \n is the conditional entropy and \n  \n    \n      \n        \n          D\n          \n            KL\n          \n        \n      \n    \n    {\\displaystyle D_{\\text{KL}}}\n  \n is the Kullback–Leibler divergence. This leads to the intuition that by maximizing the log-likelihood of a model, you are minimizing the KL divergence of your model from the maximal entropy distribution. Intuitively searching for the model that makes the fewest assumptions in its parameters.\n\n\n== Comparison with linear regression ==\nLogistic regression can be seen as a special case of the generalized linear model and thus analogous to linear regression. The model of logistic regression, however, is based on quite different assumptions (about the relationship between the dependent and independent variables) from those of linear regression. In particular, the key differences between these two models can be seen in the following two features of logistic regression. First, the conditional distribution \n  \n    \n      \n        y\n        ∣\n        x\n      \n    \n    {\\displaystyle y\\mid x}\n  \n is a Bernoulli distribution rather than a Gaussian distribution, because the dependent variable is binary. Second, the predicted values are probabilities and are therefore restricted to (0,1) through the logistic distribution function because logistic regression predicts the probability of particular outcomes rather than the outcomes themselves.\n\n\n== Alternatives ==\nA common alternative to the logistic model (logit model) is the probit model, as the related names suggest. From the perspective of generalized linear models, these differ in the choice of link function: the logistic model uses the logit function (inverse logistic function), while the probit model uses the probit function (inverse error function). Equivalently, in the latent variable interpretations of these two methods, the first assumes a standard logistic distribution of errors and the second a standard normal distribution of errors. Other sigmoid functions or error distributions can be used instead.\nLogistic regression is an alternative to Fisher's 1936 method, linear discriminant analysis.  If the assumptions of linear discriminant analysis hold, the conditioning can be reversed to produce logistic regression.  The converse is not true, however, because logistic regression does not require the multivariate normal assumption of discriminant analysis.\nThe assumption of linear predictor effects can easily be relaxed using techniques such as spline functions.\n\n\n== History ==\nA detailed history of the logistic regression is given in Cramer (2002). The logistic function was developed as a model of population growth and named \"logistic\" by Pierre François Verhulst in the 1830s and 1840s, under the guidance of Adolphe Quetelet; see Logistic function § History for details. In his earliest paper (1838), Verhulst did not specify how he fit the curves to the data. In his more detailed paper (1845), Verhulst determined the three parameters of the model by making the curve pass through three observed points, which yielded poor predictions.\nThe logistic function was independently developed in chemistry as a model of autocatalysis (Wilhelm Ostwald, 1883). An autocatalytic reaction is one in which one of the products is itself a catalyst for the same reaction, while the supply of one of the reactants is fixed. This naturally gives rise to the logistic equation for the same reason as population growth: the reaction is self-reinforcing but constrained.\nThe logistic function was independently rediscovered as a model of population growth in 1920 by Raymond Pearl and Lowell Reed, published as Pearl & Reed (1920), which led to its use in modern statistics. They were initially unaware of Verhulst's work and presumably learned about it from L. Gustave du Pasquier, but they gave him little credit and did not adopt his terminology. Verhulst's priority was acknowledged and the term \"logistic\" revived by Udny Yule in 1925 and has been followed since. Pearl and Reed first applied the model to the population of the United States, and also initially fitted the curve by making it pass through three points; as with Verhulst, this again yielded poor results.\nIn the 1930s, the probit model was developed and systematized by Chester Ittner Bliss, who coined the term \"probit\" in Bliss (1934), and by John Gaddum in Gaddum (1933), and the model fit by maximum likelihood estimation by Ronald A. Fisher in Fisher (1935), as an addendum to Bliss's work. The probit model was principally used in bioassay, and had been preceded by earlier work dating to 1860; see Probit model § History. The probit model influenced the subsequent development of the logit model and these models competed with each other.\nThe logistic model was likely first used as an alternative to the probit model in bioassay by Edwin Bidwell Wilson and his student Jane Worcester in Wilson & Worcester (1943). However, the development of the logistic model as a general alternative to the probit model was principally due to the work of Joseph Berkson over many decades, beginning in Berkson (1944), where he coined \"logit\", by analogy with \"probit\", and continuing through Berkson (1951) and following years. The logit model was initially dismissed as inferior to the probit model, but \"gradually achieved an equal footing with the probit\", particularly between 1960 and 1970. By 1970, the logit model achieved parity with the probit model in use in statistics journals and thereafter surpassed it. This relative popularity was due to the adoption of the logit outside of bioassay, rather than displacing the probit within bioassay, and its informal use in practice; the logit's popularity is credited to the logit model's computational simplicity, mathematical properties, and generality, allowing its use in varied fields.\nVarious refinements occurred during that time, notably by David Cox, as in Cox (1958).\nThe multinomial logit model was introduced independently in Cox (1966) and Theil (1969), which greatly increased the scope of application and the popularity of the logit model. In 1973 Daniel McFadden linked the multinomial logit to the theory of discrete choice, specifically Luce's choice axiom, showing that the multinomial logit followed from the assumption of independence of irrelevant alternatives and interpreting odds of alternatives as relative preferences; this gave a theoretical foundation for the logistic regression.\n\n\n== Extensions ==\nThere are large numbers of extensions:\n\nMultinomial logistic regression (or multinomial logit) handles the case of a multi-way categorical dependent variable (with unordered values, also called \"classification\").  The general case of having dependent variables with more than two values is termed polytomous regression.\nOrdered logistic regression (or ordered logit) handles ordinal dependent variables (ordered values).\nMixed logit is an extension of multinomial logit that allows for correlations among the choices of the dependent variable.\nAn extension of the logistic model to sets of interdependent variables is the conditional random field.\nConditional logistic regression handles matched or stratified data when the strata are small. It is mostly used in the analysis of observational studies.\n\n\n== See also ==\n\nLogistic function\nDiscrete choice\nJarrow–Turnbull model\nLimited dependent variable\nMultinomial logit model\nOrdered logit\nHosmer–Lemeshow test\nBrier score\nmlpack - contains a C++ implementation of logistic regression\nLocal case-control sampling\nLogistic model tree\n\n\n== References ==\n\n\n== Sources ==\n\n\n== External links ==\n\n Media related to Logistic regression at Wikimedia Commons\nEconometrics Lecture (topic: Logit model) on YouTube by Mark Thoma\nLogistic Regression tutorial\nmlelr: software in C for teaching purposes"
}